<!doctype html>
<html lang="en">
<head>
    <title>Code coverage report for app/shared/modules/wazee-frame-formatter/frame.ts</title>
    <meta charset="utf-8" />
    <link rel="stylesheet" href="../../../../prettify.css" />
    <link rel="stylesheet" href="../../../../base.css" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <style type='text/css'>
        .coverage-summary .sorter {
            background-image: url(../../../../sort-arrow-sprite.png);
        }
    </style>
</head>
<body>
<div class='wrapper'>
  <div class='pad1'>
    <h1>
      <a href="../../../../index.html">all files</a> / <a href="index.html">app/shared/modules/wazee-frame-formatter/</a> frame.ts
    </h1>
    <div class='clearfix'>
      <div class='fl pad1y space-right2'>
        <span class="strong">98.57% </span>
        <span class="quiet">Statements</span>
        <span class='fraction'>69/70</span>
      </div>
      <div class='fl pad1y space-right2'>
        <span class="strong">90.24% </span>
        <span class="quiet">Branches</span>
        <span class='fraction'>37/41</span>
      </div>
      <div class='fl pad1y space-right2'>
        <span class="strong">100% </span>
        <span class="quiet">Functions</span>
        <span class='fraction'>14/14</span>
      </div>
      <div class='fl pad1y space-right2'>
        <span class="strong">100% </span>
        <span class="quiet">Lines</span>
        <span class='fraction'>54/54</span>
      </div>
    </div>
  </div>
  <div class='status-line high'></div>
<pre><table class="coverage">
<tr><td class="line-count quiet">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107</td><td class="line-coverage quiet"><span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">124×</span>
<span class="cline-any cline-yes">124×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">62×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">3107×</span>
<span class="cline-any cline-yes">1587×</span>
<span class="cline-any cline-yes">1587×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">1587×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1565×</span>
<span class="cline-any cline-yes">1565×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1565×</span>
<span class="cline-any cline-yes">1565×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1565×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">1587×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1587×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">2005×</span>
<span class="cline-any cline-yes">1584×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1584×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1584×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1584×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">2152×</span>
<span class="cline-any cline-yes">1077×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">102×</span>
<span class="cline-any cline-yes">84×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">10×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">10×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1475×</span>
<span class="cline-any cline-yes">738×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">959×</span>
<span class="cline-any cline-yes">490×</span>
<span class="cline-any cline-yes">490×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">478×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">478×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1316×</span>
<span class="cline-any cline-yes">658×</span>
<span class="cline-any cline-yes">658×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">658×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">82×</span>
<span class="cline-any cline-yes">65×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">21×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">43×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">1929×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span></td><td class="text"><pre class="prettyprint lang-js">import { TimecodeGenerator } from './timecodeGenerator';
import { TimecodeFormat } from './timecodeFormat';
import { TimecodeParser } from './timecodeParser';
import { TimecodeBase } from './timecodeBase';
&nbsp;
const MATH = Math;
&nbsp;
export class Frame {
  public framesPerSecond: number;
  public sourceBasedOffsetFrames: any;
  public frameNumber: number;
&nbsp;
  private timecodeGenerator: TimecodeGenerator;
  private timecodeParser: TimecodeParser;
&nbsp;
  public static stringToFrameNumber(
    framesPerSecond: number,
    string: string,
    <span class="missing-if-branch" title="else path not taken" >E</span>format: TimecodeFormat = TimecodeFormat.SIMPLE_TIME_CONVERSION,
    <span class="missing-if-branch" title="else path not taken" >E</span>base: TimecodeBase = TimecodeBase.STREAM_BASED
  ): number {
    return new Frame(framesPerSecond).setFromString(string, format, base).asFrameNumber();
  };
&nbsp;
  constructor(framesPerSecond: number, sourceBasedOffset: number | string = 0) {
    this.setFramesPerSecondTo(framesPerSecond);
    this.setSourceBasedOffsetTo(sourceBasedOffset);
  }
&nbsp;
  public setFramesPerSecondTo(value: number): Frame {
    if (!value) return this;
&nbsp;
    this.framesPerSecond = value;
    if (this.framesPerSecond === 23.98) this.framesPerSecond = 23.976;
&nbsp;
    this.timecodeGenerator = new TimecodeGenerator(this.framesPerSecond);
    this.timecodeParser = new TimecodeParser(this.framesPerSecond);
&nbsp;
    return this;
  };
&nbsp;
  public setSourceBasedOffsetTo(value: number | string): Frame {
    this.sourceBasedOffsetFrames = typeof value === 'string' ? Frame.stringToFrameNumber(this.framesPerSecond, value) : value;
&nbsp;
    return this;
  };
&nbsp;
  public setFromFrameNumber(frameNumber: number, base: TimecodeBase = TimecodeBase.STREAM_BASED): Frame {
    this.frameNumber = frameNumber;
&nbsp;
    if (base === TimecodeBase.SOURCE_BASED) this.addFrames(-this.sourceBasedOffsetFrames);
&nbsp;
    <span class="missing-if-branch" title="if path not taken" >I</span>if (this.frameNumber &lt; 0) <span class="cstat-no" title="statement not covered" >this.frameNumber = 0;</span>
&nbsp;
    return this;
  };
&nbsp;
  public setFromSeconds(value: number, base: TimecodeBase = TimecodeBase.STREAM_BASED): Frame {
    return this.setFromFrameNumber(MATH.round(this.framesPerSecond * value), base);
  };
&nbsp;
  public setFromString(string: string, format: TimecodeFormat, base: TimecodeBase = TimecodeBase.STREAM_BASED): Frame {
    return this.setFromFrameNumber(this.timecodeParser.asFrameNumber(string, format), base);
  };
&nbsp;
  public addFrames(numberOfFrames: number): Frame {
    this.frameNumber += numberOfFrames;
&nbsp;
    return this;
  };
&nbsp;
  public asFrameNumber(base: TimecodeBase = TimecodeBase.STREAM_BASED): number {
    return this.frameNumberFor(base);
  };
&nbsp;
  public asSeconds(digitsAfterDecimal: number = -1, base: TimecodeBase = TimecodeBase.STREAM_BASED): number {
    const seconds = this.frameNumberFor(base) / this.framesPerSecond;
    if (digitsAfterDecimal &lt; 0) return seconds;
&nbsp;
    const multiplier = MATH.pow(10, digitsAfterDecimal);
&nbsp;
    return MATH.round(multiplier * seconds) / multiplier;
  };
&nbsp;
  public asMilliseconds(digitsAfterDecimal: number = 0, <span class="missing-if-branch" title="else path not taken" >E</span>base: TimecodeBase = TimecodeBase.STREAM_BASED): number {
    const multiplier = MATH.pow(10, digitsAfterDecimal);
    const seconds = this.frameNumberFor(base) / this.framesPerSecond;
&nbsp;
    return MATH.round(1000 * multiplier * seconds) / multiplier;
  };
&nbsp;
  public asString(format: TimecodeFormat, base: TimecodeBase = TimecodeBase.STREAM_BASED) {
    switch (format) {
      case TimecodeFormat.FRAMECOUNT:
        return this.asFrameNumber(base) + '';
      case TimecodeFormat.SECONDS:
        return this.asSeconds(3, base).toFixed(3) + '';
      default:
        return this.timecodeGenerator.setFromFrameNumber(this.frameNumberFor(base)).asString(format);
    }
  };
&nbsp;
  private frameNumberFor(base: TimecodeBase): number {
    return this.frameNumber + (base === TimecodeBase.SOURCE_BASED ? this.sourceBasedOffsetFrames : 0);
  };
}
&nbsp;</pre></td></tr>
</table></pre>
<div class='push'></div><!-- for sticky footer -->
</div><!-- /wrapper -->
<div class='footer quiet pad2 space-top1 center small'>
  Code coverage
  generated by <a href="http://istanbul-js.org/" target="_blank">istanbul</a> at Fri Feb 09 2018 23:34:45 GMT-0700 (MST)
</div>
</div>
<script src="../../../../prettify.js"></script>
<script>
window.onload = function () {
        if (typeof prettyPrint === 'function') {
            prettyPrint();
        }
};
</script>
<script src="../../../../sorter.js"></script>
</body>
</html>
