"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var Observable_1 = require("rxjs/Observable");
var mock_api_service_1 = require("../mocks/mock-api.service");
var api_interface_1 = require("../interfaces/api.interface");
var orders_service_1 = require("./orders.service");
function main() {
    describe('Orders Service', function () {
        var serviceUnderTest;
        var mockOrdersStore;
        var mockApi;
        beforeEach(function () {
            jasmine.addMatchers(mock_api_service_1.mockApiMatchers);
            mockOrdersStore = {
                replaceWith: jasmine.createSpy('replaceWith'),
                data: Observable_1.Observable.of({ some: 'data' }),
                state: { some: 'state' },
                storeOrders: jasmine.createSpy('storeOrders')
            };
            mockApi = new mock_api_service_1.MockApiService();
            serviceUnderTest = new orders_service_1.OrdersService(mockApi.injector, mockOrdersStore);
        });
        describe('data getter', function () {
            it('returns the data from the orders store', function () {
                serviceUnderTest.data.subscribe(function (data) {
                    expect(data).toEqual({ some: 'data' });
                });
            });
        });
        describe('getOrders()', function () {
            var params;
            var paramsMinusOne;
            beforeEach(function () {
                params = { i: 5, n: 20 };
                paramsMinusOne = { i: '0', n: '20' };
            });
            it('calls the API service correctly with page number', function () {
                serviceUnderTest.getOrders(params).subscribe(function (res) {
                    expect(mockApi.get).toHaveBeenCalledWithApi(api_interface_1.Api.Orders);
                    expect(mockApi.get).toHaveBeenCalledWithEndpoint('order/myOrders');
                    expect(mockApi.get).toHaveBeenCalledWithLoading(true);
                    expect(mockApi.get).toHaveBeenCalledWithParameters({ q: '', s: '', d: '', i: 4, n: 20 });
                    expect(mockOrdersStore.storeOrders).toHaveBeenCalledWith(res);
                });
            });
            it('calls the API service correctly without page number', function () {
                params = { n: 20 };
                serviceUnderTest.getOrders(params).subscribe(function (res) {
                    expect(mockApi.get).toHaveBeenCalledWithApi(api_interface_1.Api.Orders);
                    expect(mockApi.get).toHaveBeenCalledWithEndpoint('order/myOrders');
                    expect(mockApi.get).toHaveBeenCalledWithLoading(true);
                    expect(mockApi.get).toHaveBeenCalledWithParameters({ q: '', s: '', d: '', i: 0, n: 20 });
                    expect(mockOrdersStore.storeOrders).toHaveBeenCalledWith(res);
                });
            });
            it('calls the API service correctly with an invalid page number', function () {
                serviceUnderTest.getOrders({ i: -2, n: 20 }).subscribe(function (res) {
                    expect(mockApi.get).toHaveBeenCalledWithApi(api_interface_1.Api.Orders);
                    expect(mockApi.get).toHaveBeenCalledWithEndpoint('order/myOrders');
                    expect(mockApi.get).toHaveBeenCalledWithLoading(true);
                    expect(mockApi.get).toHaveBeenCalledWithParameters({ q: '', s: '', d: '', i: 0, n: 20 });
                    expect(mockOrdersStore.storeOrders).toHaveBeenCalledWith(res);
                });
            });
            it('calls the API service correctly with an alternative invalid page number', function () {
                serviceUnderTest.getOrders({ i: 0, n: 20 }).subscribe(function (res) {
                    expect(mockApi.get).toHaveBeenCalledWithApi(api_interface_1.Api.Orders);
                    expect(mockApi.get).toHaveBeenCalledWithEndpoint('order/myOrders');
                    expect(mockApi.get).toHaveBeenCalledWithLoading(true);
                    expect(mockApi.get).toHaveBeenCalledWithParameters({ q: '', s: '', d: '', i: 0, n: 20 });
                    expect(mockOrdersStore.storeOrders).toHaveBeenCalledWith(res);
                });
            });
        });
    });
}
exports.main = main;

//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC9zaGFyZWQvc2VydmljZXMvb3JkZXJzLnNlcnZpY2Uuc3BlYy50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOztBQUFBLDhDQUE2QztBQUU3Qyw4REFBNEU7QUFDNUUsNkRBQWtEO0FBQ2xELG1EQUFpRDtBQUVqRDtJQUNFLFFBQVEsQ0FBQyxnQkFBZ0IsRUFBRTtRQUN6QixJQUFJLGdCQUErQixDQUFDO1FBQ3BDLElBQUksZUFBb0IsQ0FBQztRQUN6QixJQUFJLE9BQXVCLENBQUM7UUFFNUIsVUFBVSxDQUFDO1lBQ1QsT0FBTyxDQUFDLFdBQVcsQ0FBQyxrQ0FBZSxDQUFDLENBQUM7WUFFckMsZUFBZSxHQUFHO2dCQUNoQixXQUFXLEVBQUUsT0FBTyxDQUFDLFNBQVMsQ0FBQyxhQUFhLENBQUM7Z0JBQzdDLElBQUksRUFBRSx1QkFBVSxDQUFDLEVBQUUsQ0FBQyxFQUFFLElBQUksRUFBRSxNQUFNLEVBQUUsQ0FBQztnQkFDckMsS0FBSyxFQUFFLEVBQUUsSUFBSSxFQUFFLE9BQU8sRUFBRTtnQkFDeEIsV0FBVyxFQUFFLE9BQU8sQ0FBQyxTQUFTLENBQUMsYUFBYSxDQUFDO2FBQzlDLENBQUM7WUFFRixPQUFPLEdBQUcsSUFBSSxpQ0FBYyxFQUFFLENBQUM7WUFDL0IsZ0JBQWdCLEdBQUcsSUFBSSw4QkFBYSxDQUFDLE9BQU8sQ0FBQyxRQUFRLEVBQUUsZUFBZSxDQUFDLENBQUM7UUFDMUUsQ0FBQyxDQUFDLENBQUM7UUFFSCxRQUFRLENBQUMsYUFBYSxFQUFFO1lBQ3RCLEVBQUUsQ0FBQyx3Q0FBd0MsRUFBRTtnQkFDM0MsZ0JBQWdCLENBQUMsSUFBSSxDQUFDLFNBQVMsQ0FBQyxVQUFBLElBQUk7b0JBQ2xDLE1BQU0sQ0FBQyxJQUFJLENBQUMsQ0FBQyxPQUFPLENBQUMsRUFBRSxJQUFJLEVBQUUsTUFBTSxFQUFFLENBQUMsQ0FBQztnQkFDekMsQ0FBQyxDQUFDLENBQUM7WUFDTCxDQUFDLENBQUMsQ0FBQztRQUNMLENBQUMsQ0FBQyxDQUFD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Q0FBQyxDQUFDLENBQUM7WUFDTCxDQUFDLENBQUMsQ0FBQztRQUNMLENBQUMsQ0FBQyxDQUFDO0lBRUwsQ0FBQyxDQUFDLENBQUM7QUFDTCxDQUFDO0FBakZELG9CQWlGQyIsImZpbGUiOiJhcHAvc2hhcmVkL3NlcnZpY2VzL29yZGVycy5zZXJ2aWNlLnNwZWMuanMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBPYnNlcnZhYmxlIH0gZnJvbSAncnhqcy9PYnNlcnZhYmxlJztcblxuaW1wb3J0IHsgTW9ja0FwaVNlcnZpY2UsIG1vY2tBcGlNYXRjaGVycyB9IGZyb20gJy4uL21vY2tzL21vY2stYXBpLnNlcnZpY2UnO1xuaW1wb3J0IHsgQXBpIH0gZnJvbSAnLi4vaW50ZXJmYWNlcy9hcGkuaW50ZXJmYWNlJztcbmltcG9ydCB7IE9yZGVyc1NlcnZpY2UgfSBmcm9tICcuL29yZGVycy5zZXJ2aWNlJztcblxuZXhwb3J0IGZ1bmN0aW9uIG1haW4oKSB7XG4gIGRlc2NyaWJlKCdPcmRlcnMgU2VydmljZScsICgpID0+IHtcbiAgICBsZXQgc2VydmljZVVuZGVyVGVzdDogT3JkZXJzU2VydmljZTtcbiAgICBsZXQgbW9ja09yZGVyc1N0b3JlOiBhbnk7XG4gICAgbGV0IG1vY2tBcGk6IE1vY2tBcGlTZXJ2aWNlO1xuXG4gICAgYmVmb3JlRWFjaCgoKSA9PiB7XG4gICAgICBqYXNtaW5lLmFkZE1hdGNoZXJzKG1vY2tBcGlNYXRjaGVycyk7XG5cbiAgICAgIG1vY2tPcmRlcnNTdG9yZSA9IHtcbiAgICAgICAgcmVwbGFjZVdpdGg6IGphc21pbmUuY3JlYXRlU3B5KCdyZXBsYWNlV2l0aCcpLFxuICAgICAgICBkYXRhOiBPYnNlcnZhYmxlLm9mKHsgc29tZTogJ2RhdGEnIH0pLFxuICAgICAgICBzdGF0ZTogeyBzb21lOiAnc3RhdGUnIH0sXG4gICAgICAgIHN0b3JlT3JkZXJzOiBqYXNtaW5lLmNyZWF0ZVNweSgnc3RvcmVPcmRlcnMnKVxuICAgICAgfTtcblxuICAgICAgbW9ja0FwaSA9IG5ldyBNb2NrQXBpU2VydmljZSgpO1xuICAgICAgc2VydmljZVVuZGVyVGVzdCA9IG5ldyBPcmRlcnNTZXJ2aWNlKG1vY2tBcGkuaW5qZWN0b3IsIG1vY2tPcmRlcnNTdG9yZSk7XG4gICAgfSk7XG5cbiAgICBkZXNjcmliZSgnZGF0YSBnZXR0ZXInLCAoKSA9PiB7XG4gICAgICBpdCgncmV0dXJucyB0aGUgZGF0YSBmcm9tIHRoZSBvcmRlcnMgc3RvcmUnLCAoKSA9PiB7XG4gICAgICAgIHNlcnZpY2VVbmRlclRlc3QuZGF0YS5zdWJzY3JpYmUoZGF0YSA9PiB7XG4gICAgICAgICAgZXhwZWN0KGRhdGEpLnRvRXF1YWwoeyBzb21lOiAnZGF0YScgfSk7XG4gICAgICAgIH0pO1xuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICBkZXNjcmliZSgnZ2V0T3JkZXJzKCknLCAoKSA9PiB7XG4gICAgICBsZXQgcGFyYW1zOiBhbnk7XG4gICAgICBsZXQgcGFyYW1zTWludXNPbmU6IGFueTtcblxuICAgICAgYmVmb3JlRWFjaCgoKSA9PiB7XG4gICAgICAgIHBhcmFtcyA9IHsgaTogNSwgbjogMjAgfTtcbiAgICAgICAgcGFyYW1zTWludXNPbmUgPSB7IGk6ICcwJywgbjogJzIwJyB9O1xuICAgICAgfSk7XG5cblxuICAgICAgaXQoJ2NhbGxzIHRoZSBBUEkgc2VydmljZSBjb3JyZWN0bHkgd2l0aCBwYWdlIG51bWJlcicsICgpID0+IHtcbiAgICAgICAgc2VydmljZVVuZGVyVGVzdC5nZXRPcmRlcnMocGFyYW1zKS5zdWJzY3JpYmUoKHJlcykgPT4ge1xuICAgICAgICAgIGV4cGVjdChtb2NrQXBpLmdldCkudG9IYXZlQmVlbkNhbGxlZFdpdGhBcGkoQXBpLk9yZGVycyk7XG4gICAgICAgICAgZXhwZWN0KG1vY2tBcGkuZ2V0KS50b0hhdmVCZWVuQ2FsbGVkV2l0aEVuZHBvaW50KCdvcmRlci9teU9yZGVycycpO1xuICAgICAgICAgIGV4cGVjdChtb2NrQXBpLmdldCkudG9IYXZlQmVlbkNhbGxlZFdpdGhMb2FkaW5nKHRydWUpO1xuICAgICAgICAgIGV4cGVjdChtb2NrQXBpLmdldCkudG9IYXZlQmVlbkNhbGxlZFdpdGhQYXJhbWV0ZXJzKHsgcTogJycsIHM6ICcnLCBkOiAnJywgaTogNCwgbjogMjAgfSk7XG4gICAgICAgICAgZXhwZWN0KG1vY2tPcmRlcnNTdG9yZS5zdG9yZU9yZGVycykudG9IYXZlQmVlbkNhbGxlZFdpdGgocmVzKTtcbiAgICAgICAgfSk7XG4gICAgICB9KTtcblxuICAgICAgaXQoJ2NhbGxzIHRoZSBBUEkgc2VydmljZSBjb3JyZWN0bHkgd2l0aG91dCBwYWdlIG51bWJlcicsICgpID0+IHtcbiAgICAgICAgcGFyYW1zID0geyBuOiAyMCB9O1xuICAgICAgICBzZXJ2aWNlVW5kZXJUZXN0LmdldE9yZGVycyhwYXJhbXMpLnN1YnNjcmliZSgocmVzKSA9PiB7XG4gICAgICAgICAgZXhwZWN0KG1vY2tBcGkuZ2V0KS50b0hhdmVCZWVuQ2FsbGVkV2l0aEFwaShBcGkuT3JkZXJzKTtcbiAgICAgICAgICBleHBlY3QobW9ja0FwaS5nZXQpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoRW5kcG9pbnQoJ29yZGVyL215T3JkZXJzJyk7XG4gICAgICAgICAgZXhwZWN0KG1vY2tBcGkuZ2V0KS50b0hhdmVCZWVuQ2FsbGVkV2l0aExvYWRpbmcodHJ1ZSk7XG4gICAgICAgICAgZXhwZWN0KG1vY2tBcGkuZ2V0KS50b0hhdmVCZWVuQ2FsbGVkV2l0aFBhcmFtZXRlcnMoeyBxOiAnJywgczogJycsIGQ6ICcnLCBpOiAwLCBuOiAyMCB9KTtcbiAgICAgICAgICBleHBlY3QobW9ja09yZGVyc1N0b3JlLnN0b3JlT3JkZXJzKS50b0hhdmVCZWVuQ2FsbGVkV2l0aChyZXMpO1xuICAgICAgICB9KTtcbiAgICAgIH0pO1xuXG4gICAgICBpdCgnY2FsbHMgdGhlIEFQSSBzZXJ2aWNlIGNvcnJlY3RseSB3aXRoIGFuIGludmFsaWQgcGFnZSBudW1iZXInLCAoKSA9PiB7XG4gICAgICAgIHNlcnZpY2VVbmRlclRlc3QuZ2V0T3JkZXJzKHsgaTogLTIsIG46IDIwIH0pLnN1YnNjcmliZSgocmVzKSA9PiB7XG4gICAgICAgICAgZXhwZWN0KG1vY2tBcGkuZ2V0KS50b0hhdmVCZWVuQ2FsbGVkV2l0aEFwaShBcGkuT3JkZXJzKTtcbiAgICAgICAgICBleHBlY3QobW9ja0FwaS5nZXQpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoRW5kcG9pbnQoJ29yZGVyL215T3JkZXJzJyk7XG4gICAgICAgICAgZXhwZWN0KG1vY2tBcGkuZ2V0KS50b0hhdmVCZWVuQ2FsbGVkV2l0aExvYWRpbmcodHJ1ZSk7XG4gICAgICAgICAgZXhwZWN0KG1vY2tBcGkuZ2V0KS50b0hhdmVCZWVuQ2FsbGVkV2l0aFBhcmFtZXRlcnMoeyBxOiAnJywgczogJycsIGQ6ICcnLCBpOiAwLCBuOiAyMCB9KTtcbiAgICAgICAgICBleHBlY3QobW9ja09yZGVyc1N0b3JlLnN0b3JlT3JkZXJzKS50b0hhdmVCZWVuQ2FsbGVkV2l0aChyZXMpO1xuICAgICAgICB9KTtcbiAgICAgIH0pO1xuXG4gICAgICBpdCgnY2FsbHMgdGhlIEFQSSBzZXJ2aWNlIGNvcnJlY3RseSB3aXRoIGFuIGFsdGVybmF0aXZlIGludmFsaWQgcGFnZSBudW1iZXInLCAoKSA9PiB7XG4gICAgICAgIHNlcnZpY2VVbmRlclRlc3QuZ2V0T3JkZXJzKHsgaTogMCwgbjogMjAgfSkuc3Vic2NyaWJlKChyZXMpID0+IHtcbiAgICAgICAgICBleHBlY3QobW9ja0FwaS5nZXQpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoQXBpKEFwaS5PcmRlcnMpO1xuICAgICAgICAgIGV4cGVjdChtb2NrQXBpLmdldCkudG9IYXZlQmVlbkNhbGxlZFdpdGhFbmRwb2ludCgnb3JkZXIvbXlPcmRlcnMnKTtcbiAgICAgICAgICBleHBlY3QobW9ja0FwaS5nZXQpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoTG9hZGluZyh0cnVlKTtcbiAgICAgICAgICBleHBlY3QobW9ja0FwaS5nZXQpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoUGFyYW1ldGVycyh7IHE6ICcnLCBzOiAnJywgZDogJycsIGk6IDAsIG46IDIwIH0pO1xuICAgICAgICAgIGV4cGVjdChtb2NrT3JkZXJzU3RvcmUuc3RvcmVPcmRlcnMpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKHJlcyk7XG4gICAgICAgIH0pO1xuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgfSk7XG59XG4iXX0=
