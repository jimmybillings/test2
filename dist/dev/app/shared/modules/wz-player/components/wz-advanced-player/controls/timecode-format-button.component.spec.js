"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var timecode_format_button_component_1 = require("./timecode-format-button.component");
var index_1 = require("../../../../wazee-frame-formatter/index");
function main() {
    describe('Timecode Format Button Component', function () {
        var componentUnderTest;
        beforeEach(function () {
            componentUnderTest = new timecode_format_button_component_1.TimecodeFormatButtonComponent();
            componentUnderTest.request.emit = jasmine.createSpy('request emitter');
        });
        describe('currentTimecodeFormatBaseTranslationKey getter', function () {
            it('returns the correct key for stream-based timecode', function () {
                componentUnderTest.playerState = {
                    timecodeBase: index_1.TimecodeBase.STREAM_BASED, timecodeFormat: index_1.TimecodeFormat.SIMPLE_TIME_CONVERSION
                };
                expect(componentUnderTest.currentTimecodeFormatBaseTranslationKey)
                    .toBe('ASSET.ADV_PLAYER.TIMECODE_FORMAT_BASE_DISPLAY.STREAM_BASED_TIMECODE');
            });
            it('returns the correct key for source-based timecode', function () {
                componentUnderTest.playerState = {
                    timecodeBase: index_1.TimecodeBase.SOURCE_BASED, timecodeFormat: index_1.TimecodeFormat.SIMPLE_TIME_CONVERSION
                };
                expect(componentUnderTest.currentTimecodeFormatBaseTranslationKey)
                    .toBe('ASSET.ADV_PLAYER.TIMECODE_FORMAT_BASE_DISPLAY.SOURCE_BASED_TIMECODE');
            });
            it('returns the correct key for stream-based seconds', function () {
                componentUnderTest.playerState = {
                    timecodeBase: index_1.TimecodeBase.STREAM_BASED, timecodeFormat: index_1.TimecodeFormat.SECONDS
                };
                expect(componentUnderTest.currentTimecodeFormatBaseTranslationKey)
                    .toBe('ASSET.ADV_PLAYER.TIMECODE_FORMAT_BASE_DISPLAY.STREAM_BASED_SECONDS');
            });
            it('returns the correct key for source-based seconds', function () {
                componentUnderTest.playerState = {
                    timecodeBase: index_1.TimecodeBase.SOURCE_BASED, timecodeFormat: index_1.TimecodeFormat.SECONDS
                };
                expect(componentUnderTest.currentTimecodeFormatBaseTranslationKey)
                    .toBe('ASSET.ADV_PLAYER.TIMECODE_FORMAT_BASE_DISPLAY.SOURCE_BASED_SECONDS');
            });
        });
        describe('currentFrame getter', function () {
            it('returns the expected frame', function () {
                componentUnderTest.playerState = { currentFrame: { some: 'frame' } };
                expect(componentUnderTest.currentFrame).toEqual({ some: 'frame' });
            });
        });
        describe('canSelectSourceBased getter', function () {
            it('returns false if the player state has no current frame', function () {
                componentUnderTest.playerState = {};
                expect(componentUnderTest.canSelectSourceBased).toBe(false);
            });
            it('returns false if the player state\'s current frame has a zero offset', function () {
                componentUnderTest.playerState = { currentFrame: { sourceBasedOffsetFrames: 0 } };
                expect(componentUnderTest.canSelectSourceBased).toBe(false);
            });
            it('returns true if the player state\'s current frame has an offset greater than 0', function () {
                componentUnderTest.playerState = { currentFrame: { sourceBasedOffsetFrames: 1 } };
                expect(componentUnderTest.canSelectSourceBased).toBe(true);
            });
        });
        describe('selectStreamBasedTimecode()', function () {
            it('emits the expected request', function () {
                componentUnderTest.selectStreamBasedTimecode();
                expect(componentUnderTest.request.emit).toHaveBeenCalledWith({
                    type: 'CHANGE_TIMECODE_DISPLAY',
                    format: index_1.TimecodeFormat.SIMPLE_TIME_CONVERSION,
                    base: index_1.TimecodeBase.STREAM_BASED
                });
            });
        });
        describe('selectSourceBasedTimecode()', function () {
            it('emits the expected request', function () {
                componentUnderTest.selectSourceBasedTimecode();
                expect(componentUnderTest.request.emit).toHaveBeenCalledWith({
                    type: 'CHANGE_TIMECODE_DISPLAY',
                    format: index_1.TimecodeFormat.SIMPLE_TIME_CONVERSION,
                    base: index_1.TimecodeBase.SOURCE_BASED
                });
            });
        });
        describe('selectStreamBasedSeconds()', function () {
            it('emits the expected request', function () {
                componentUnderTest.selectStreamBasedSeconds();
                expect(componentUnderTest.request.emit).toHaveBeenCalledWith({
                    type: 'CHANGE_TIMECODE_DISPLAY',
                    format: index_1.TimecodeFormat.SECONDS,
                    base: index_1.TimecodeBase.STREAM_BASED
                });
            });
        });
    });
}
exports.main = main;

//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC9zaGFyZWQvbW9kdWxlcy93ei1wbGF5ZXIvY29tcG9uZW50cy93ei1hZHZhbmNlZC1wbGF5ZXIvY29udHJvbHMvdGltZWNvZGUtZm9ybWF0LWJ1dHRvbi5jb21wb25lbnQuc3BlYy50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOztBQUFBLHVGQUFtRjtBQUNuRixpRUFBdUY7QUFFdkY7SUFDRSxRQUFRLENBQUMsa0NBQWtDLEVBQUU7UUFDM0MsSUFBSSxrQkFBaUQsQ0FBQztRQUV0RCxVQUFVLENBQUM7WUFDVCxrQkFBa0IsR0FBRyxJQUFJLGdFQUE2QixFQUFFLENBQUM7WUFDekQsa0JBQWtCLENBQUMsT0FBTyxDQUFDLElBQUksR0FBRyxPQUFPLENBQUMsU0FBUyxDQUFDLGlCQUFpQixDQUFDLENBQUM7UUFDekUsQ0FBQyxDQUFDLENBQUM7UUFFSCxRQUFRLENBQUMsZ0RBQWdELEVBQUU7WUFDekQsRUFBRSxDQUFDLG1EQUFtRCxFQUFFO2dCQUN0RCxrQkFBa0IsQ0FBQyxXQUFXLEdBQUc7b0JBQy9CLFlBQVksRUFBRSxvQkFBWSxDQUFDLFlBQVksRUFBRSxjQUFjLEVBQUUsc0JBQWMsQ0FBQyxzQkFBc0I7aUJBQ3hGLENBQUM7Z0JBRVQsTUFBTSxDQUFDLGtCQUFrQixDQUFDLHVDQUF1QyxDQUFDO3FCQUMvRCxJQUFJLENBQUMscUVBQXFFLENBQUMsQ0FBQztZQUNqRixDQUFDLENBQUMsQ0FBQztZQUVILEVBQUUsQ0FBQyxtREFBbUQsRUFBRTtnQkFDdEQsa0JBQWtCLENBQUMsV0FBVyxHQUFHO29CQUMvQixZQUFZLEVBQUUsb0JBQVksQ0FBQyxZQUFZLEVBQUUsY0FBYyxFQUFFLHNCQUFjLENBQUMsc0JBQXNCO2lCQUN4RixDQUFDO2dCQUVULE1BQU0sQ0FBQyxrQkFBa0IsQ0FBQyx1Q0FBdUMsQ0FBQztxQkFDL0QsSUFBSSxDQUFDLHFFQUFxRSxDQUFDLENBQUM7WUFDakYsQ0FBQyxDQUFDLENBQUM7WUFFSCxFQUFFLENBQUMsa0RBQWtE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QUUseUJBQXlCO29CQUMvQixNQUFNLEVBQUUsc0JBQWMsQ0FBQyxzQkFBc0I7b0JBQzdDLElBQUksRUFBRSxvQkFBWSxDQUFDLFlBQVk7aUJBQ2hDLENBQUMsQ0FBQztZQUNMLENBQUMsQ0FBQyxDQUFDO1FBQ0wsQ0FBQyxDQUFDLENBQUM7UUFFSCxRQUFRLENBQUMsNEJBQTRCLEVBQUU7WUFDckMsRUFBRSxDQUFDLDRCQUE0QixFQUFFO2dCQUMvQixrQkFBa0IsQ0FBQyx3QkFBd0IsRUFBRSxDQUFDO2dCQUU5QyxNQUFNLENBQUMsa0JBQWtCLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxDQUFDLG9CQUFvQixDQUFDO29CQUMzRCxJQUFJLEVBQUUseUJBQXlCO29CQUMvQixNQUFNLEVBQUUsc0JBQWMsQ0FBQyxPQUFPO29CQUM5QixJQUFJLEVBQUUsb0JBQVksQ0FBQyxZQUFZO2lCQUNoQyxDQUFDLENBQUM7WUFDTCxDQUFDLENBQUMsQ0FBQztRQUNMLENBQUMsQ0FBQyxDQUFDO0lBQ0wsQ0FBQyxDQUFDLENBQUM7QUFDTCxDQUFDO0FBaEhELG9CQWdIQyIsImZpbGUiOiJhcHAvc2hhcmVkL21vZHVsZXMvd3otcGxheWVyL2NvbXBvbmVudHMvd3otYWR2YW5jZWQtcGxheWVyL2NvbnRyb2xzL3RpbWVjb2RlLWZvcm1hdC1idXR0b24uY29tcG9uZW50LnNwZWMuanMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBUaW1lY29kZUZvcm1hdEJ1dHRvbkNvbXBvbmVudCB9IGZyb20gJy4vdGltZWNvZGUtZm9ybWF0LWJ1dHRvbi5jb21wb25lbnQnO1xuaW1wb3J0IHsgVGltZWNvZGVGb3JtYXQsIFRpbWVjb2RlQmFzZSB9IGZyb20gJy4uLy4uLy4uLy4uL3dhemVlLWZyYW1lLWZvcm1hdHRlci9pbmRleCc7XG5cbmV4cG9ydCBmdW5jdGlvbiBtYWluKCkge1xuICBkZXNjcmliZSgnVGltZWNvZGUgRm9ybWF0IEJ1dHRvbiBDb21wb25lbnQnLCAoKSA9PiB7XG4gICAgbGV0IGNvbXBvbmVudFVuZGVyVGVzdDogVGltZWNvZGVGb3JtYXRCdXR0b25Db21wb25lbnQ7XG5cbiAgICBiZWZvcmVFYWNoKCgpID0+IHtcbiAgICAgIGNvbXBvbmVudFVuZGVyVGVzdCA9IG5ldyBUaW1lY29kZUZvcm1hdEJ1dHRvbkNvbXBvbmVudCgpO1xuICAgICAgY29tcG9uZW50VW5kZXJUZXN0LnJlcXVlc3QuZW1pdCA9IGphc21pbmUuY3JlYXRlU3B5KCdyZXF1ZXN0IGVtaXR0ZXInKTtcbiAgICB9KTtcblxuICAgIGRlc2NyaWJlKCdjdXJyZW50VGltZWNvZGVGb3JtYXRCYXNlVHJhbnNsYXRpb25LZXkgZ2V0dGVyJywgKCkgPT4ge1xuICAgICAgaXQoJ3JldHVybnMgdGhlIGNvcnJlY3Qga2V5IGZvciBzdHJlYW0tYmFzZWQgdGltZWNvZGUnLCAoKSA9PiB7XG4gICAgICAgIGNvbXBvbmVudFVuZGVyVGVzdC5wbGF5ZXJTdGF0ZSA9IHtcbiAgICAgICAgICB0aW1lY29kZUJhc2U6IFRpbWVjb2RlQmFzZS5TVFJFQU1fQkFTRUQsIHRpbWVjb2RlRm9ybWF0OiBUaW1lY29kZUZvcm1hdC5TSU1QTEVfVElNRV9DT05WRVJTSU9OXG4gICAgICAgIH0gYXMgYW55O1xuXG4gICAgICAgIGV4cGVjdChjb21wb25lbnRVbmRlclRlc3QuY3VycmVudFRpbWVjb2RlRm9ybWF0QmFzZVRyYW5zbGF0aW9uS2V5KVxuICAgICAgICAgIC50b0JlKCdBU1NFVC5BRFZfUExBWUVSLlRJTUVDT0RFX0ZPUk1BVF9CQVNFX0RJU1BMQVkuU1RSRUFNX0JBU0VEX1RJTUVDT0RFJyk7XG4gICAgICB9KTtcblxuICAgICAgaXQoJ3JldHVybnMgdGhlIGNvcnJlY3Qga2V5IGZvciBzb3VyY2UtYmFzZWQgdGltZWNvZGUnLCAoKSA9PiB7XG4gICAgICAgIGNvbXBvbmVudFVuZGVyVGVzdC5wbGF5ZXJTdGF0ZSA9IHtcbiAgICAgICAgICB0aW1lY29kZUJhc2U6IFRpbWVjb2RlQmFzZS5TT1VSQ0VfQkFTRUQsIHRpbWVjb2RlRm9ybWF0OiBUaW1lY29kZUZvcm1hdC5TSU1QTEVfVElNRV9DT05WRVJTSU9OXG4gICAgICAgIH0gYXMgYW55O1xuXG4gICAgICAgIGV4cGVjdChjb21wb25lbnRVbmRlclRlc3QuY3VycmVudFRpbWVjb2RlRm9ybWF0QmFzZVRyYW5zbGF0aW9uS2V5KVxuICAgICAgICAgIC50b0JlKCdBU1NFVC5BRFZfUExBWUVSLlRJTUVDT0RFX0ZPUk1BVF9CQVNFX0RJU1BMQVkuU09VUkNFX0JBU0VEX1RJTUVDT0RFJyk7XG4gICAgICB9KTtcblxuICAgICAgaXQoJ3JldHVybnMgdGhlIGNvcnJlY3Qga2V5IGZvciBzdHJlYW0tYmFzZWQgc2Vjb25kcycsICgpID0+IHtcbiAgICAgICAgY29tcG9uZW50VW5kZXJUZXN0LnBsYXllclN0YXRlID0ge1xuICAgICAgICAgIHRpbWVjb2RlQmFzZTogVGltZWNvZGVCYXNlLlNUUkVBTV9CQVNFRCwgdGltZWNvZGVGb3JtYXQ6IFRpbWVjb2RlRm9ybWF0LlNFQ09ORFNcbiAgICAgICAgfSBhcyBhbnk7XG5cbiAgICAgICAgZXhwZWN0KGNvbXBvbmVudFVuZGVyVGVzdC5jdXJyZW50VGltZWNvZGVGb3JtYXRCYXNlVHJhbnNsYXRpb25LZXkpXG4gICAgICAgICAgLnRvQmUoJ0FTU0VULkFEVl9QTEFZRVIuVElNRUNPREVfRk9STUFUX0JBU0VfRElTUExBWS5TVFJFQU1fQkFTRURfU0VDT05EUycpO1xuICAgICAgfSk7XG5cbiAgICAgIGl0KCdyZXR1cm5zIHRoZSBjb3JyZWN0IGtleSBmb3Igc291cmNlLWJhc2VkIHNlY29uZHMnLCAoKSA9PiB7XG4gICAgICAgIC8vIEV2ZW4gdGhvdWdoIHdlIGRvbid0IGN1cnJlbnRseSBhbGxvdyB0aGUgdXNlciB0byBzZWxlY3QgdGhpcy5cbiAgICAgICAgY29tcG9uZW50VW5kZXJUZXN0LnBsYXllclN0YXRlID0ge1xuICAgICAgICAgIHRpbWVjb2RlQmFzZTogVGltZWNvZGVCYXNlLlNPVVJDRV9CQVNFRCwgdGltZWNvZGVGb3JtYXQ6IFRpbWVjb2RlRm9ybWF0LlNFQ09ORFNcbiAgICAgICAgfSBhcyBhbnk7XG5cbiAgICAgICAgZXhwZWN0KGNvbXBvbmVudFVuZGVyVGVzdC5jdXJyZW50VGltZWNvZGVGb3JtYXRCYXNlVHJhbnNsYXRpb25LZXkpXG4gICAgICAgICAgLnRvQmUoJ0FTU0VULkFEVl9QTEFZRVIuVElNRUNPREVfRk9STUFUX0JBU0VfRElTUExBWS5TT1VSQ0VfQkFTRURfU0VDT05EUycpO1xuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICBkZXNjcmliZSgnY3VycmVudEZyYW1lIGdldHRlcicsICgpID0+IHtcbiAgICAgIGl0KCdyZXR1cm5zIHRoZSBleHBlY3RlZCBmcmFtZScsICgpID0+IHtcbiAgICAgICAgY29tcG9uZW50VW5kZXJUZXN0LnBsYXllclN0YXRlID0geyBjdXJyZW50RnJhbWU6IHsgc29tZTogJ2ZyYW1lJyB9IH0gYXMgYW55O1xuXG4gICAgICAgIGV4cGVjdChjb21wb25lbnRVbmRlclRlc3QuY3VycmVudEZyYW1lKS50b0VxdWFsKHsgc29tZTogJ2ZyYW1lJyB9KTtcbiAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgZGVzY3JpYmUoJ2NhblNlbGVjdFNvdXJjZUJhc2VkIGdldHRlcicsICgpID0+IHtcbiAgICAgIGl0KCdyZXR1cm5zIGZhbHNlIGlmIHRoZSBwbGF5ZXIgc3RhdGUgaGFzIG5vIGN1cnJlbnQgZnJhbWUnLCAoKSA9PiB7XG4gICAgICAgIGNvbXBvbmVudFVuZGVyVGVzdC5wbGF5ZXJTdGF0ZSA9IHt9IGFzIGFueTtcblxuICAgICAgICBleHBlY3QoY29tcG9uZW50VW5kZXJUZXN0LmNhblNlbGVjdFNvdXJjZUJhc2VkKS50b0JlKGZhbHNlKTtcbiAgICAgIH0pO1xuXG4gICAgICBpdCgncmV0dXJucyBmYWxzZSBpZiB0aGUgcGxheWVyIHN0YXRlXFwncyBjdXJyZW50IGZyYW1lIGhhcyBhIHplcm8gb2Zmc2V0JywgKCkgPT4ge1xuICAgICAgICBjb21wb25lbnRVbmRlclRlc3QucGxheWVyU3RhdGUgPSB7IGN1cnJlbnRGcmFtZTogeyBzb3VyY2VCYXNlZE9mZnNldEZyYW1lczogMCB9IH0gYXMgYW55O1xuXG4gICAgICAgIGV4cGVjdChjb21wb25lbnRVbmRlclRlc3QuY2FuU2VsZWN0U291cmNlQmFzZWQpLnRvQmUoZmFsc2UpO1xuICAgICAgfSk7XG5cbiAgICAgIGl0KCdyZXR1cm5zIHRydWUgaWYgdGhlIHBsYXllciBzdGF0ZVxcJ3MgY3VycmVudCBmcmFtZSBoYXMgYW4gb2Zmc2V0IGdyZWF0ZXIgdGhhbiAwJywgKCkgPT4ge1xuICAgICAgICBjb21wb25lbnRVbmRlclRlc3QucGxheWVyU3RhdGUgPSB7IGN1cnJlbnRGcmFtZTogeyBzb3VyY2VCYXNlZE9mZnNldEZyYW1lczogMSB9IH0gYXMgYW55O1xuXG4gICAgICAgIGV4cGVjdChjb21wb25lbnRVbmRlclRlc3QuY2FuU2VsZWN0U291cmNlQmFzZWQpLnRvQmUodHJ1ZSk7XG4gICAgICB9KTtcbiAgICB9KTtcblxuICAgIGRlc2NyaWJlKCdzZWxlY3RTdHJlYW1CYXNlZFRpbWVjb2RlKCknLCAoKSA9PiB7XG4gICAgICBpdCgnZW1pdHMgdGhlIGV4cGVjdGVkIHJlcXVlc3QnLCAoKSA9PiB7XG4gICAgICAgIGNvbXBvbmVudFVuZGVyVGVzdC5zZWxlY3RTdHJlYW1CYXNlZFRpbWVjb2RlKCk7XG5cbiAgICAgICAgZXhwZWN0KGNvbXBvbmVudFVuZGVyVGVzdC5yZXF1ZXN0LmVtaXQpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKHtcbiAgICAgICAgICB0eXBlOiAnQ0hBTkdFX1RJTUVDT0RFX0RJU1BMQVknLFxuICAgICAgICAgIGZvcm1hdDogVGltZWNvZGVGb3JtYXQuU0lNUExFX1RJTUVfQ09OVkVSU0lPTixcbiAgICAgICAgICBiYXNlOiBUaW1lY29kZUJhc2UuU1RSRUFNX0JBU0VEXG4gICAgICAgIH0pO1xuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICBkZXNjcmliZSgnc2VsZWN0U291cmNlQmFzZWRUaW1lY29kZSgpJywgKCkgPT4ge1xuICAgICAgaXQoJ2VtaXRzIHRoZSBleHBlY3RlZCByZXF1ZXN0JywgKCkgPT4ge1xuICAgICAgICBjb21wb25lbnRVbmRlclRlc3Quc2VsZWN0U291cmNlQmFzZWRUaW1lY29kZSgpO1xuXG4gICAgICAgIGV4cGVjdChjb21wb25lbnRVbmRlclRlc3QucmVxdWVzdC5lbWl0KS50b0hhdmVCZWVuQ2FsbGVkV2l0aCh7XG4gICAgICAgICAgdHlwZTogJ0NIQU5HRV9USU1FQ09ERV9ESVNQTEFZJyxcbiAgICAgICAgICBmb3JtYXQ6IFRpbWVjb2RlRm9ybWF0LlNJTVBMRV9USU1FX0NPTlZFUlNJT04sXG4gICAgICAgICAgYmFzZTogVGltZWNvZGVCYXNlLlNPVVJDRV9CQVNFRFxuICAgICAgICB9KTtcbiAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgZGVzY3JpYmUoJ3NlbGVjdFN0cmVhbUJhc2VkU2Vjb25kcygpJywgKCkgPT4ge1xuICAgICAgaXQoJ2VtaXRzIHRoZSBleHBlY3RlZCByZXF1ZXN0JywgKCkgPT4ge1xuICAgICAgICBjb21wb25lbnRVbmRlclRlc3Quc2VsZWN0U3RyZWFtQmFzZWRTZWNvbmRzKCk7XG5cbiAgICAgICAgZXhwZWN0KGNvbXBvbmVudFVuZGVyVGVzdC5yZXF1ZXN0LmVtaXQpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKHtcbiAgICAgICAgICB0eXBlOiAnQ0hBTkdFX1RJTUVDT0RFX0RJU1BMQVknLFxuICAgICAgICAgIGZvcm1hdDogVGltZWNvZGVGb3JtYXQuU0VDT05EUyxcbiAgICAgICAgICBiYXNlOiBUaW1lY29kZUJhc2UuU1RSRUFNX0JBU0VEXG4gICAgICAgIH0pO1xuICAgICAgfSk7XG4gICAgfSk7XG4gIH0pO1xufVxuIl19
