"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var asset_service_1 = require("./asset.service");
var mock_api_service_1 = require("../spec-helpers/mock-api.service");
var api_interface_1 = require("../../shared/interfaces/api.interface");
function main() {
    describe('Asset Service', function () {
        var serviceUnderTest;
        var mockApiService;
        beforeEach(function () {
            jasmine.addMatchers(mock_api_service_1.mockApiMatchers);
            mockApiService = new mock_api_service_1.MockApiService();
            mockApiService.getResponse = { some: 'asset' };
            serviceUnderTest = new asset_service_1.AssetService(mockApiService.injector);
        });
        describe('load()', function () {
            it('calls the API correctly with just an asset ID', function () {
                serviceUnderTest.load({ id: '47' }, 'search');
                expect(mockApiService.get).toHaveBeenCalledWithApi(api_interface_1.Api.Assets);
                expect(mockApiService.get).toHaveBeenCalledWithEndpoint('clip/47/clipDetail');
                expect(mockApiService.get).toHaveBeenCalledWithLoading(true);
                expect(mockApiService.get).not.toHaveBeenCalledWithOverridingToken(jasmine.any(String));
            });
            it('calls the API correctly with a share key', function () {
                serviceUnderTest.load({ id: '47', share_key: 'some_key' }, 'search');
                expect(mockApiService.get).toHaveBeenCalledWithApi(api_interface_1.Api.Assets);
                expect(mockApiService.get).toHaveBeenCalledWithEndpoint('clip/47/clipDetail');
                expect(mockApiService.get).toHaveBeenCalledWithLoading(true);
                expect(mockApiService.get).toHaveBeenCalledWithOverridingToken('some_key');
            });
            it('calls the API service correctly with a collectionAsset', function () {
                serviceUnderTest.load({ id: '123' }, 'collection', 321);
                expect(mockApiService.get).toHaveBeenCalledWithApi(api_interface_1.Api.Assets);
                expect(mockApiService.get).toHaveBeenCalledWithEndpoint('clip/123/collection/321/clipDetail');
                expect(mockApiService.get).toHaveBeenCalledWithLoading(true);
            });
            it('calls the API service correctly with a orderAsset', function () {
                serviceUnderTest.load({ id: '123' }, 'order', 321);
                expect(mockApiService.get).toHaveBeenCalledWithApi(api_interface_1.Api.Assets);
                expect(mockApiService.get).toHaveBeenCalledWithEndpoint('clip/123/order/321/clipDetail');
                expect(mockApiService.get).toHaveBeenCalledWithLoading(true);
            });
            it('calls the API service correctly with a quoteShow asset', function () {
                serviceUnderTest.load({ id: '123' }, 'quoteShow', 321);
                expect(mockApiService.get).toHaveBeenCalledWithApi(api_interface_1.Api.Assets);
                expect(mockApiService.get).toHaveBeenCalledWithEndpoint('clip/123/quote/321/clipDetail');
                expect(mockApiService.get).toHaveBeenCalledWithLoading(true);
            });
            it('calls the API service correctly with a quoteEdit Asset', function () {
                serviceUnderTest.load({ id: '123' }, 'quoteEdit', 321);
                expect(mockApiService.get).toHaveBeenCalledWithApi(api_interface_1.Api.Assets);
                expect(mockApiService.get).toHaveBeenCalledWithEndpoint('clip/123/quote/321/clipDetail');
                expect(mockApiService.get).toHaveBeenCalledWithLoading(true);
            });
            it('returns the expected Observable with just an asset ID', function () {
                var returnedAsset;
                serviceUnderTest.load({ id: '47' }, 'search').subscribe(function (asset) {
                    expect(asset).toEqual({ some: 'asset', uuid: null, timeStart: null, timeEnd: null });
                });
            });
            it('returns the expected Observable with a UUID', function () {
                var returnedAsset;
                serviceUnderTest.load({ id: '47', uuid: 'ABCDEFG' }, 'search').subscribe(function (asset) { return returnedAsset = asset; });
                expect(returnedAsset).toEqual({ some: 'asset', uuid: 'ABCDEFG', timeStart: null, timeEnd: null });
            });
            it('returns the expected Observable with a negative timeStart', function () {
                var returnedAsset;
                serviceUnderTest.load({ id: '47', timeStart: '-1' }, 'search').subscribe(function (asset) { return returnedAsset = asset; });
                expect(returnedAsset).toEqual({ some: 'asset', uuid: null, timeStart: null, timeEnd: null });
            });
            it('returns the expected Observable with a zero timeStart', function () {
                var returnedAsset;
                serviceUnderTest.load({ id: '47', timeStart: '0' }, 'search').subscribe(function (asset) { return returnedAsset = asset; });
                expect(returnedAsset).toEqual({ some: 'asset', uuid: null, timeStart: 0, timeEnd: null });
            });
            it('returns the expected Observable with a positive timeStart', function () {
                var returnedAsset;
                serviceUnderTest.load({ id: '47', timeStart: '1' }, 'search').subscribe(function (asset) { return returnedAsset = asset; });
                expect(returnedAsset).toEqual({ some: 'asset', uuid: null, timeStart: 1, timeEnd: null });
            });
            it('returns the expected Observable with a negative timeEnd', function () {
                var returnedAsset;
                serviceUnderTest.load({ id: '47', timeEnd: '-1' }, 'search').subscribe(function (asset) { return returnedAsset = asset; });
                expect(returnedAsset).toEqual({ some: 'asset', uuid: null, timeStart: null, timeEnd: null });
            });
            it('returns the expected Observable with a zero timeEnd', function () {
                var returnedAsset;
                serviceUnderTest.load({ id: '47', timeEnd: '0' }, 'search').subscribe(function (asset) { return returnedAsset = asset; });
                expect(returnedAsset).toEqual({ some: 'asset', uuid: null, timeStart: null, timeEnd: 0 });
            });
            it('returns the expected Observable with a positive timeEnd', function () {
                var returnedAsset;
                serviceUnderTest.load({ id: '47', timeEnd: '1' }, 'search').subscribe(function (asset) { return returnedAsset = asset; });
                expect(returnedAsset).toEqual({ some: 'asset', uuid: null, timeStart: null, timeEnd: 1 });
            });
        });
    });
    describe('Legacy Asset Service', function () {
        var serviceUnderTest;
        var mockApiService;
        beforeEach(function () {
            jasmine.addMatchers(mock_api_service_1.mockApiMatchers);
            mockApiService = new mock_api_service_1.MockApiService();
            mockApiService.getResponse = { some: 'asset' };
            serviceUnderTest = new asset_service_1.LegacyAssetService(mockApiService.injector);
        });
        describe('createShareLink()', function () {
            it('calls the API correctly', function () {
            });
        });
        describe('getClipPreviewData()', function () {
            it('calls the API correctly', function () {
            });
        });
    });
}
exports.main = main;

//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC9zdG9yZS9hc3NldC9hc3NldC5zZXJ2aWNlLnNwZWMudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7QUFBQSxpREFBbUU7QUFDbkUscUVBQW1GO0FBQ25GLHVFQUE0RDtBQUU1RDtJQUNFLFFBQVEsQ0FBQyxlQUFlLEVBQUU7UUFDeEIsSUFBSSxnQkFBOEIsQ0FBQztRQUNuQyxJQUFJLGNBQThCLENBQUM7UUFFbkMsVUFBVSxDQUFDO1lBQ1QsT0FBTyxDQUFDLFdBQVcsQ0FBQyxrQ0FBZSxDQUFDLENBQUM7WUFDckMsY0FBYyxHQUFHLElBQUksaUNBQWMsRUFBRSxDQUFDO1lBQ3RDLGNBQWMsQ0FBQyxXQUFXLEdBQUcsRUFBRSxJQUFJLEVBQUUsT0FBTyxFQUFFLENBQUM7WUFDL0MsZ0JBQWdCLEdBQUcsSUFBSSw0QkFBWSxDQUFDLGNBQWMsQ0FBQyxRQUFRLENBQUMsQ0FBQztRQUMvRCxDQUFDLENBQUMsQ0FBQztRQUVILFFBQVEsQ0FBQyxRQUFRLEVBQUU7WUFDakIsRUFBRSxDQUFDLCtDQUErQyxFQUFFO2dCQUNsRCxnQkFBZ0IsQ0FBQyxJQUFJLENBQUMsRUFBRSxFQUFFLEVBQUUsSUFBSSxFQUFFLEVBQUUsUUFBUSxDQUFDLENBQUM7Z0JBRTlDLE1BQU0sQ0FBQyxjQUFjLENBQUMsR0FBRyxDQUFDLENBQUMsdUJBQXVCLENBQUMsbUJBQUcsQ0FBQyxNQUFNLENBQUMsQ0FBQztnQkFDL0QsTUFBTSxDQUFDLGNBQWMsQ0FBQyxHQUFHLENBQUMsQ0FBQyw0QkFBNEIsQ0FBQyxvQkFBb0IsQ0FBQyxDQUFDO2dCQUM5RSxNQUFNLENBQUMsY0FBYyxDQUFDLEdBQUcsQ0FBQyxDQUFDLDJCQUEyQixDQUFDLElBQUksQ0FBQyxDQUFDO2dCQUM3RCxNQUFNLENBQUMsY0FBYyxDQUFDLEdBQUcsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxtQ0FBbUMsQ0FBQyxPQUFPLENBQUMsR0FBRyxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUM7WUFDMUYsQ0FBQyxDQUFDLENBQUM7WUFFSCxFQUFFLENBQUMsMENBQTBDLEVBQUU7Z0JBQzdDLGdCQUFnQixDQUFDLElBQUksQ0FBQyxFQUFFLEVBQUUsRUFBRSxJQUFJLEVBQUUsU0FBUyxFQUFFLFVBQVUsRUFBRSxFQUFFLFFBQVEsQ0FBQyxDQUFDO2dCQUVyRSxNQUFNLENBQUMsY0FBYyxDQUFDLEdBQUcsQ0FBQyxDQUFDLHVCQUF1QixDQUFDLG1CQUFHLENBQUMsTUFBTSxDQUFDLENBQUM7Z0JBQy9ELE1BQU0sQ0FBQyxjQUFjLENBQUMsR0FBRyxDQUFDLENBQUMsNEJBQTRCLENBQUMsb0JBQW9CLENBQUMsQ0FBQztnQkFDOUUsTUFBTSxDQUFDLGNBQWMsQ0FBQyxHQUFHLENBQUMsQ0FBQywyQkFBMkIsQ0FBQyxJQUFJLENBQUMsQ0FBQztnQkFDN0QsTUFBTSxDQUFDLGNBQWMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxtQ0FBbUMsQ0FBQyxVQUFVLENBQUMsQ0FBQztZQUM3RSxDQUFDLENBQUMsQ0FBQztZQUVILEVBQUUsQ0FBQyx3REFBd0QsRUFBRTtnQkFDM0QsZ0JBQWdCLENBQUMsSUFBSSxDQUFDLEVBQUUsRUFBRSxFQUFFLEtBQUssRUFBRSxFQUFFLFlBQVksRUFBRSxHQUFHLENBQUMsQ0FBQztnQkFFeEQsTUFBTSxDQUFDLGNBQWMsQ0FBQyxHQUFHLENBQUMsQ0FBQyx1QkFBdUIsQ0FBQyxtQkFBRyxDQUFDLE1BQU0sQ0FBQyxDQUFDO2dCQUMvRCxNQUFNLENBQUMsY0FBYyxDQUFDLEdBQUcsQ0FBQyxDQUFDLDRCQUE0QixDQUFDLG9DQUFvQyxDQUFDLENBQUM7Z0JBQzlGLE1BQU0sQ0FBQyxjQUFjLENBQUMsR0FBRyxDQUFDLENBQUMsMkJBQTJCLENBQUMsSUFBSSxDQUFDLENBQUM7WUFDL0QsQ0FBQyxDQUFDLENBQUM7WUFFSCxFQUFFLENBQUMsbURBQW1ELEVBQUU7Z0JBQ3RELGdCQUFnQixDQUFDLElBQUksQ0FBQyxFQUFFLEVBQUUsRUFBRSxLQUFLLEVBQUUsRUFBRSxPQUFPLEVBQUUsR0FBRyxDQUFDLENBQUM7Z0JBRW5ELE1BQU0sQ0FBQyxjQUFjLENBQUMsR0FBRyxDQUFDLENBQUMsdUJBQXVCLENBQUMsbUJBQUcsQ0FBQyxNQUFNLENBQUMsQ0FBQztnQkFDL0QsTUFBTSxDQUFDLGNBQWMsQ0FBQyxHQUFHLENBQUMsQ0FBQyw0QkFBNEIsQ0FBQywrQkFBK0IsQ0FBQyxDQUFDO2dCQUN6RixNQUFNLENBQUMsY0FBYyxDQUFDLEdBQUcsQ0FBQyxDQUFDLDJCQUEyQixDQUFDLElBQUksQ0FBQyxDQUFDO1lBQy9ELENBQUMsQ0FBQyxDQUFDO1lBRUgsRUFBRSxDQUFDLHdEQUF3RCxFQUFFO2dCQUMzRCxnQkFBZ0IsQ0FBQyxJQUFJLENBQUMsRUFBRSxFQUFFLEVBQUUsS0FBSyxFQUFFLEVBQUUsV0FBVyxFQUFFLEdBQUcsQ0FBQyxDQUFDO2dCQUV2RCxNQUFNLENBQUMsY0FBYyxDQUFDLEdBQUcsQ0FBQyxDQUFDLHVCQUF1QixDQUFDLG1CQUFHLENBQUMsTUFBTSxDQUFDLENBQUM7Z0JBQy9ELE1BQU0sQ0FBQyxjQUFjLENBQUMsR0FBRyxDQUFDLENBQUMsNEJBQTRCLENBQUMsK0JBQStCLENBQUMsQ0FBQztnQkFDekYsTUFBTSxDQUFDLGNBQWMsQ0FBQyxHQUFHLENBQUMsQ0FBQywyQkFBMkIsQ0FBQyxJQUFJLENBQUMsQ0FBQztZQUMvRCxDQUFDLENBQUMsQ0FBQztZQUVILEVBQUUsQ0FBQyx3REFBd0QsRUFBRTtnQkFDM0QsZ0JBQWdCLENBQUMsSUFBSSxDQUFDLEVBQUUsRUFBRSxFQUFFLEtBQUssRUFBRSxFQUFFLFdBQVcsRUFBRSxHQUFHLENBQUMsQ0FBQztnQkFFdkQsTUFBTSxDQUFDLGNBQWMsQ0FBQyxHQUFHLENBQUMsQ0FBQyx1QkFBdUIsQ0FBQyxtQkFBRyxDQUFDLE1BQU0sQ0FBQyxDQUFDO2dCQUMvRCxNQUFNLENBQUMsY0FBYyxDQUFDLEdBQUcsQ0FBQyxDQUFDLDRCQUE0QixDQUFDLCtCQUErQixDQUFDLENBQUM7Z0JBQ3pGLE1BQU0sQ0FBQyxjQUFjLENBQUMsR0FBRyxDQUFDLENBQUMsMkJBQTJCLENBQUMsSUFBSSxDQUFDLENBQUM7WUFDL0QsQ0FBQyxDQUFDLENBQUM7WUFFSCxFQUFFLENBQUMsdURBQXVELEVBQUU7Z0JBQzFELElBQUksYUFBa0IsQ0FBQztnQkFDdkIsZ0JBQWdCLENBQUMsSUFBSSxDQUFDLEVBQUUsRUFBRSxFQUFFLElBQUksRUFBRSxFQUFFLFFBQVEsQ0FBQyxDQUFDLFNBQVMsQ0FBQyxVQUFBLEtBQUs7b0JBQzNELE1BQU0sQ0FBQyxLQUFLLENBQUMsQ0FBQyxPQUFPLENBQUMsRUFBRSxJQUFJLEVBQUUsT0FBTyxFQUFFLElBQUksRUFBRSxJQUFJLEVBQUUsU0FBUyxFQUFFLElBQUksRUFBRSxPQUFPLEVBQUUsSUFBSSxFQUFFLENBQUMsQ0FBQztnQkFDdkYsQ0FBQyxDQUFDLENBQUM7WUFDTCxDQUFDLENBQUMsQ0FBQztZQUVILEVBQUUsQ0FBQyw2Q0FBNkMsRUFBRTtnQkFDaEQsSUFBSSxhQUFrQixDQUFDO2dCQUN2QixnQkFBZ0IsQ0FBQyxJQUFJLENBQUMsRUFBRSxFQUFFLEVBQUUsSUFBSSxFQUFFLElBQUksRUFBRSxTQUFTLEVBQUUsRUFBRSxRQUFRLENBQUMsQ0FBQyxTQUFTLENBQUMsVUFBQSxLQUFLLElBQUksT0FBQSxhQUFhLEdBQUcsS0FBSyxFQUFyQixDQUFxQixDQUFDLENBQUM7Z0JBQ3pHLE1BQU0sQ0FBQyxhQUFhLENBQUMsQ0FBQyxPQUFPLENBQUMsRUFBRSxJQUFJLEVBQUUsT0FBTyxFQUFFLElBQUksRUFBRSxTQUFTLEVBQUUsU0FBUyxFQUFFLElBQUksRUFBRSxPQUFPLEVBQUUsSUFBSSxFQUFFLENBQUMsQ0FBQztZQUNwRyxDQUFDLENBQUMsQ0FBQztZQUVILEVBQUUsQ0FBQywyREFBMkQsRUFBRTtnQkFDOUQsSUFBSSxhQUFrQixDQUFDO2dCQUN2QixnQkFBZ0IsQ0FBQyxJQUFJLENBQUMsRUFBRSxFQUFFLEVBQUUsSUFBSSxFQUFFLFNBQVMsRUFBRSxJQUFJLEVBQUUsRUFBRSxRQUFRLENBQUMsQ0FBQyxTQUFTLENBQUMsVUFBQSxLQUFLLElBQUksT0FBQSxhQUFhLEdBQUcsS0FBSyxFQUFyQixDQUFxQixDQUFDLENBQUM7Z0JBQ3pHLE1BQU0sQ0FBQyxhQUFhLENBQUMsQ0FBQyxPQUFPLENBQUMsRUFBRSxJQUFJLEVBQUUsT0FBTyxFQUFFLElBQUksRUFBRSxJQUFJLEVBQUUsU0FBUyxFQUFFLElBQUksRUFBRSxPQUFPLEVBQUUsSUFBSSxFQUFFLENBQUMsQ0FBQztZQUMvRixDQUFDLENBQUMsQ0FBQztZQUVILEVBQUUsQ0FBQyx1REFBdUQsRUFBRTtnQkFDMUQsSUFBSSxhQUFrQixDQUFDO2dCQUN2QixnQkFBZ0IsQ0FBQyxJQUFJLENBQUMsRUFBRSxFQUFFLEVBQUUsSUFBSSxFQUFFLFNBQVMsRUFBRSxHQUFHLEVBQUUsRUFBRSxRQUFRLENBQUMsQ0FBQyxTQUFTLENBQUMsVUFBQSxLQUFLLElBQUksT0FBQSxhQUFhLEdBQUcsS0FBSyxFQUFyQixDQUFxQixDQUFDLENBQUM7Z0JBQ3hHLE1BQU0sQ0FBQyxhQUFhLENBQUMsQ0FBQyxPQUFPLENBQUMsRUFBRSxJQUFJLEVBQUUsT0FBTyxFQUFFLElBQUksRUFBRSxJQUFJLEVBQUUsU0FBUyxFQUFFLENBQUMsRUFBRSxPQUFPLEVBQUUsSUFBSSxFQUFFLENBQUMsQ0FBQztZQUM1RixDQUFDLENBQUMsQ0FBQztZQUVILEVBQUUsQ0FBQywyREFBMkQsRUFBRTtnQkFDOUQsSUFBSSxhQUFrQixDQUFDO2dCQUN2QixnQkFBZ0IsQ0FBQyxJQUFJLENBQUMsRUFBRSxFQUFFLEVBQUUsSUFBSSxFQUFFLFNBQVMsRUFBRSxHQUFHLEVBQUUsRUFBRSxRQUFRLENBQUMsQ0FBQyxTQUFTLENBQUMsVUFBQSxLQUFLLElBQUksT0FBQSxhQUFhLEdBQUcsS0FBSyxFQUFyQixDQUFxQixDQUFDLENBQUM7Z0JBQ3hHLE1BQU0sQ0FBQyxhQUFhLENBQUMsQ0FBQyxPQUFPLENBQUMsRUFBRSxJQUFJLEVBQUUsT0FBTyxFQUFFLElBQUksRUFBRSxJQUFJLEVBQUUsU0FBUyxFQUFFLENBQUMsRUFBRSxPQUFPLEVBQUUsSUFBSSxFQUFFLENBQUMsQ0FBQztZQUM1RixDQUFDLENBQUMsQ0FBQztZQUVILEVBQUUsQ0FBQyx5REFBeUQsRUFBRTtnQkFDNUQsSUFBSSxhQUFrQixDQUFDO2dCQUN2QixnQkFBZ0IsQ0FBQyxJQUFJLENBQUMsRUFBRSxFQUFFLEVBQUUsSUFBSSxFQUFFLE9BQU8sRUFBRSxJQUFJLEVBQUUsRUFBRSxRQUFRLENBQUMsQ0FBQyxTQUFTLENBQUMsVUFBQSxLQUFLLElBQUksT0FBQSxhQUFhLEdBQUcsS0FBSyxFQUFyQixDQUFxQixDQUFDLENBQUM7Z0JBQ3ZHLE1BQU0sQ0FBQyxhQUFhLENBQUMsQ0FBQyxPQUFPLENBQUMsRUFBRSxJQUFJLEVBQUUsT0FBTyxFQUFFLElBQUksRUFBRSxJQUFJLEVBQUUsU0FBUyxFQUFFLElBQUksRUFBRSxPQUFPLEVBQUUsSUFBSSxFQUFFLENBQUMsQ0FBQztZQUMvRixDQUFDLENBQUMsQ0FBQztZQUVILEVBQUUsQ0FBQyxxREFBcUQsRUFBRTtnQkFDeEQsSUFBSSxhQUFrQixDQUFDO2dCQUN2QixnQkFBZ0IsQ0FBQyxJQUFJLENBQUMsRUFBRSxFQUFFLEVBQUUsSUFBSSxFQUFFLE9BQU8sRUFBRSxHQUFHLEVBQUUsRUFBRSxRQUFRLENBQUMsQ0FBQyxTQUFTLENBQUMsVUFBQSxLQUFLLElBQUksT0FBQSxhQUFhLEdBQUcsS0FBSyxFQUFyQixDQUFxQixDQUFDLENBQUM7Z0JBQ3RHLE1BQU0sQ0FBQyxhQUFhLENBQUMsQ0FBQyxPQUFPLENBQUMsRUFBRSxJQUFJLEVBQUUsT0FBTyxFQUFFLElBQUksRUFBRSxJQUFJLEVBQUUsU0FBUyxFQUFFLElBQUksRUFBRSxPQUFPLEVBQUUsQ0FBQyxFQUFFLENBQUMsQ0FBQztZQUM1RixDQUFDLENBQUMsQ0FBQztZQUVILEVBQUUsQ0FBQyx5REFBeUQsRUFBRTtnQkFDNUQsSUFBSSxhQUFrQixDQUFDO2dCQUN2QixnQkFBZ0IsQ0FBQyxJQUFJLENBQUMsRUFBRSxFQUFFLEVBQUUsSUFBSSxFQUFFLE9BQU8sRUFBRSxHQUFHLEVBQUUsRUFBRSxRQUFRLENBQUMsQ0FBQyxTQUFTLENBQUMsVUFBQSxLQUFLLElBQUksT0FBQSxhQUFhLEdBQUcsS0FBSyxFQUFyQixDQUFxQixDQUFDLENBQUM7Z0JBQ3RHLE1BQU0sQ0FBQyxhQUFhLENBQUMsQ0FBQyxPQUFPLENBQUMsRUFBRSxJQUFJLEVBQUUsT0FBTyxFQUFFLElBQUksRUFBRSxJQUFJLEVBQUUsU0FBUyxFQUFFLElBQUksRUFBRSxPQUFPLEVBQUUsQ0FBQyxFQUFFLENBQUMsQ0FBQztZQUM1RixDQUFDLENBQUMsQ0FBQztRQUNMLENBQUMsQ0FBQyxDQUFDO0lBQ0wsQ0FBQyxDQUFDLENBQUM7SUFFSCxRQUFRLENBQUMsc0JBQXNCLEVBQUU7UUFDL0IsSUFBSSxnQkFBb0MsQ0FBQztRQUN6QyxJQUFJLGNBQThCLENBQUM7UUFFbkMsVUFBVSxDQUFDO1lBQ1QsT0FBTyxDQUFDLFdBQVcsQ0FBQyxrQ0FBZSxDQUFDLENBQUM7WUFDckMsY0FBYyxHQUFHLElBQUksaUNBQWMsRUFBRSxDQUFDO1lBQ3RDLGNBQWMsQ0FBQyxXQUFXLEdBQUcsRUFBRSxJQUFJLEVBQUUsT0FBTyxFQUFFLENBQUM7WUFFL0MsZ0JBQWdCLEdBQUcsSUFBSSxrQ0FBa0IsQ0FBQyxjQUFjLENBQUMsUUFBUSxDQUFDLENBQUM7UUFDckUsQ0FBQyxDQUFDLENBQUM7UUFFSCxRQUFRLENBQUMsbUJBQW1CLEVBQUU7WUFDNUIsRUFBRSxDQUFDLHlCQUF5QixFQUFFO1lBSzlCLENBQUMsQ0FBQyxDQUFDO1FBQ0wsQ0FBQyxDQUFDLENBQUM7UUFFSCxRQUFRLENBQUMsc0JBQXNCLEVBQUU7WUFDL0IsRUFBRSxDQUFDLHlCQUF5QixFQUFFO1lBSzlCLENBQUMsQ0FBQyxDQUFDO1FBQ0wsQ0FBQyxDQUFDLENBQUM7SUFDTCxDQUFDLENBQUMsQ0FBQztBQUNMLENBQUM7QUFoSkQsb0JBZ0pDIiwiZmlsZSI6ImFwcC9zdG9yZS9hc3NldC9hc3NldC5zZXJ2aWNlLnNwZWMuanMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBBc3NldFNlcnZpY2UsIExlZ2FjeUFzc2V0U2VydmljZSB9IGZyb20gJy4vYXNzZXQuc2VydmljZSc7XG5pbXBvcnQgeyBNb2NrQXBpU2VydmljZSwgbW9ja0FwaU1hdGNoZXJzIH0gZnJvbSAnLi4vc3BlYy1oZWxwZXJzL21vY2stYXBpLnNlcnZpY2UnO1xuaW1wb3J0IHsgQXBpIH0gZnJvbSAnLi4vLi4vc2hhcmVkL2ludGVyZmFjZXMvYXBpLmludGVyZmFjZSc7XG5cbmV4cG9ydCBmdW5jdGlvbiBtYWluKCkge1xuICBkZXNjcmliZSgnQXNzZXQgU2VydmljZScsICgpID0+IHtcbiAgICBsZXQgc2VydmljZVVuZGVyVGVzdDogQXNzZXRTZXJ2aWNlO1xuICAgIGxldCBtb2NrQXBpU2VydmljZTogTW9ja0FwaVNlcnZpY2U7XG5cbiAgICBiZWZvcmVFYWNoKCgpID0+IHtcbiAgICAgIGphc21pbmUuYWRkTWF0Y2hlcnMobW9ja0FwaU1hdGNoZXJzKTtcbiAgICAgIG1vY2tBcGlTZXJ2aWNlID0gbmV3IE1vY2tBcGlTZXJ2aWNlKCk7XG4gICAgICBtb2NrQXBpU2VydmljZS5nZXRSZXNwb25zZSA9IHsgc29tZTogJ2Fzc2V0JyB9O1xuICAgICAgc2VydmljZVVuZGVyVGVzdCA9IG5ldyBBc3NldFNlcnZpY2UobW9ja0FwaVNlcnZpY2UuaW5qZWN0b3IpO1xuICAgIH0pO1xuXG4gICAgZGVzY3JpYmUoJ2xvYWQoKScsICgpID0+IHtcbiAgICAgIGl0KCdjYWxscyB0aGUgQVBJIGNvcnJlY3RseSB3aXRoIGp1c3QgYW4gYXNzZXQgSUQnLCAoKSA9PiB7XG4gICAgICAgIHNlcnZpY2VVbmRlclRlc3QubG9hZCh7IGlkOiAnNDcnIH0sICdzZWFyY2gnKTtcblxuICAgICAgICBleHBlY3QobW9ja0FwaVNlcnZpY2UuZ2V0KS50b0hhdmVCZWVuQ2FsbGVkV2l0aEFwaShBcGkuQXNzZXRzKTtcbiAgICAgICAgZXhwZWN0KG1vY2tBcGlTZXJ2aWNlLmdldCkudG9IYXZlQmVlbkNhbGxlZFdpdGhFbmRwb2ludCgnY2xpcC80Ny9jbGlwRGV0YWlsJyk7XG4gICAgICAgIGV4cGVjdChtb2NrQXBpU2VydmljZS5nZXQpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoTG9hZGluZyh0cnVlKTtcbiAgICAgICAgZXhwZWN0KG1vY2tBcGlTZXJ2aWNlLmdldCkubm90LnRvSGF2ZUJlZW5DYWxsZWRXaXRoT3ZlcnJpZGluZ1Rva2VuKGphc21pbmUuYW55KFN0cmluZykpO1xuICAgICAgfSk7XG5cbiAgICAgIGl0KCdjYWxscyB0aGUgQVBJIGNvcnJlY3RseSB3aXRoIGEgc2hhcmUga2V5JywgKCkgPT4ge1xuICAgICAgICBzZXJ2aWNlVW5kZXJUZXN0LmxvYWQoeyBpZDogJzQ3Jywgc2hhcmVfa2V5OiAnc29tZV9rZXknIH0sICdzZWFyY2gnKTtcblxuICAgICAgICBleHBlY3QobW9ja0FwaVNlcnZpY2UuZ2V0KS50b0hhdmVCZWVuQ2FsbGVkV2l0aEFwaShBcGkuQXNzZXRzKTtcbiAgICAgICAgZXhwZWN0KG1vY2tBcGlTZXJ2aWNlLmdldCkudG9IYXZlQmVlbkNhbGxlZFdpdGhFbmRwb2ludCgnY2xpcC80Ny9jbGlwRGV0YWlsJyk7XG4gICAgICAgIGV4cGVjdChtb2NrQXBpU2VydmljZS5nZXQpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoTG9hZGluZyh0cnVlKTtcbiAgICAgICAgZXhwZWN0KG1vY2tBcGlTZXJ2aWNlLmdldCkudG9IYXZlQmVlbkNhbGxlZFdpdGhPdmVycmlkaW5nVG9rZW4oJ3NvbWVfa2V5Jyk7XG4gICAgICB9KTtcblxuICAgICAgaXQoJ2NhbGxzIHRoZSBBUEkgc2VydmljZSBjb3JyZWN0bHkgd2l0aCBhIGNvbGxlY3Rpb25Bc3NldCcsICgpID0+IHtcbiAgICAgICAgc2VydmljZVVuZGVyVGVzdC5sb2FkKHsgaWQ6ICcxMjMnIH0sICdjb2xsZWN0aW9uJywgMzIxKTtcblxuICAgICAgICBleHBlY3QobW9ja0FwaVNlcnZpY2UuZ2V0KS50b0hhdmVCZWVuQ2FsbGVkV2l0aEFwaShBcGkuQXNzZXRzKTtcbiAgICAgICAgZXhwZWN0KG1vY2tBcGlTZXJ2aWNlLmdldCkudG9IYXZlQmVlbkNhbGxlZFdpdGhFbmRwb2ludCgnY2xpcC8xMjMvY29sbGVjdGlvbi8zMjEvY2xpcERldGFpbCcpO1xuICAgICAgICBleHBlY3QobW9ja0FwaVNlcnZpY2UuZ2V0KS50b0hhdmVCZWVuQ2FsbGVkV2l0aExvYWRpbmcodHJ1ZSk7XG4gICAgICB9KTtcblxuICAgICAgaXQoJ2NhbGxzIHRoZSBBUEkgc2VydmljZSBjb3JyZWN0bHkgd2l0aCBhIG9yZGVyQXNzZXQnLCAoKSA9PiB7XG4gICAgICAgIHNlcnZpY2VVbmRlclRlc3QubG9hZCh7IGlkOiAnMTIzJyB9LCAnb3JkZXInLCAzMjEpO1xuXG4gICAgICAgIGV4cGVjdChtb2NrQXBpU2VydmljZS5nZXQpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoQXBpKEFwaS5Bc3NldHMpO1xuICAgICAgICBleHBlY3QobW9ja0FwaVNlcnZpY2UuZ2V0KS50b0hhdmVCZWVuQ2FsbGVkV2l0aEVuZHBvaW50KCdjbGlwLzEyMy9vcmRlci8zMjEvY2xpcERldGFpbCcpO1xuICAgICAgICBleHBlY3QobW9ja0FwaVNlcnZpY2UuZ2V0KS50b0hhdmVCZWVuQ2FsbGVkV2l0aExvYWRpbmcodHJ1ZSk7XG4gICAgICB9KTtcblxuICAgICAgaXQoJ2NhbGxzIHRoZSBBUEkgc2VydmljZSBjb3JyZWN0bHkgd2l0aCBhIHF1b3RlU2hvdyBhc3NldCcsICgpID0+IHtcbiAgICAgICAgc2VydmljZVVuZGVyVGVzdC5sb2FkKHsgaWQ6ICcxMjMnIH0sICdxdW90ZVNob3cnLCAzMjEpO1xuXG4gICAgICAgIGV4cGVjdChtb2NrQXBpU2VydmljZS5nZXQpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoQXBpKEFwaS5Bc3NldHMpO1xuICAgICAgICBleHBlY3QobW9ja0FwaVNlcnZpY2UuZ2V0KS50b0hhdmVCZWVuQ2FsbGVkV2l0aEVuZHBvaW50KCdjbGlwLzEyMy9xdW90ZS8zMjEvY2xpcERldGFpbCcpO1xuICAgICAgICBleHBlY3QobW9ja0FwaVNlcnZpY2UuZ2V0KS50b0hhdmVCZWVuQ2FsbGVkV2l0aExvYWRpbmcodHJ1ZSk7XG4gICAgICB9KTtcblxuICAgICAgaXQoJ2NhbGxzIHRoZSBBUEkgc2VydmljZSBjb3JyZWN0bHkgd2l0aCBhIHF1b3RlRWRpdCBBc3NldCcsICgpID0+IHtcbiAgICAgICAgc2VydmljZVVuZGVyVGVzdC5sb2FkKHsgaWQ6ICcxMjMnIH0sICdxdW90ZUVkaXQnLCAzMjEpO1xuXG4gICAgICAgIGV4cGVjdChtb2NrQXBpU2VydmljZS5nZXQpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoQXBpKEFwaS5Bc3NldHMpO1xuICAgICAgICBleHBlY3QobW9ja0FwaVNlcnZpY2UuZ2V0KS50b0hhdmVCZWVuQ2FsbGVkV2l0aEVuZHBvaW50KCdjbGlwLzEyMy9xdW90ZS8zMjEvY2xpcERldGFpbCcpO1xuICAgICAgICBleHBlY3QobW9ja0FwaVNlcnZpY2UuZ2V0KS50b0hhdmVCZWVuQ2FsbGVkV2l0aExvYWRpbmcodHJ1ZSk7XG4gICAgICB9KTtcblxuICAgICAgaXQoJ3JldHVybnMgdGhlIGV4cGVjdGVkIE9ic2VydmFibGUgd2l0aCBqdXN0IGFuIGFzc2V0IElEJywgKCkgPT4ge1xuICAgICAgICBsZXQgcmV0dXJuZWRBc3NldDogYW55O1xuICAgICAgICBzZXJ2aWNlVW5kZXJUZXN0LmxvYWQoeyBpZDogJzQ3JyB9LCAnc2VhcmNoJykuc3Vic2NyaWJlKGFzc2V0ID0+IHtcbiAgICAgICAgICBleHBlY3QoYXNzZXQpLnRvRXF1YWwoeyBzb21lOiAnYXNzZXQnLCB1dWlkOiBudWxsLCB0aW1lU3RhcnQ6IG51bGwsIHRpbWVFbmQ6IG51bGwgfSk7XG4gICAgICAgIH0pO1xuICAgICAgfSk7XG5cbiAgICAgIGl0KCdyZXR1cm5zIHRoZSBleHBlY3RlZCBPYnNlcnZhYmxlIHdpdGggYSBVVUlEJywgKCkgPT4ge1xuICAgICAgICBsZXQgcmV0dXJuZWRBc3NldDogYW55O1xuICAgICAgICBzZXJ2aWNlVW5kZXJUZXN0LmxvYWQoeyBpZDogJzQ3JywgdXVpZDogJ0FCQ0RFRkcnIH0sICdzZWFyY2gnKS5zdWJzY3JpYmUoYXNzZXQgPT4gcmV0dXJuZWRBc3NldCA9IGFzc2V0KTtcbiAgICAgICAgZXhwZWN0KHJldHVybmVkQXNzZXQpLnRvRXF1YWwoeyBzb21lOiAnYXNzZXQnLCB1dWlkOiAnQUJDREVGRycsIHRpbWVTdGFydDogbnVsbCwgdGltZUVuZDogbnVsbCB9KTtcbiAgICAgIH0pO1xuXG4gICAgICBpdCgncmV0dXJucyB0aGUgZXhwZWN0ZWQgT2JzZXJ2YWJsZSB3aXRoIGEgbmVnYXRpdmUgdGltZVN0YXJ0JywgKCkgPT4ge1xuICAgICAgICBsZXQgcmV0dXJuZWRBc3NldDogYW55O1xuICAgICAgICBzZXJ2aWNlVW5kZXJUZXN0LmxvYWQoeyBpZDogJzQ3JywgdGltZVN0YXJ0OiAnLTEnIH0sICdzZWFyY2gnKS5zdWJzY3JpYmUoYXNzZXQgPT4gcmV0dXJuZWRBc3NldCA9IGFzc2V0KTtcbiAgICAgICAgZXhwZWN0KHJldHVybmVkQXNzZXQpLnRvRXF1YWwoeyBzb21lOiAnYXNzZXQnLCB1dWlkOiBudWxsLCB0aW1lU3RhcnQ6IG51bGwsIHRpbWVFbmQ6IG51bGwgfSk7XG4gICAgICB9KTtcblxuICAgICAgaXQoJ3JldHVybnMgdGhlIGV4cGVjdGVkIE9ic2VydmFibGUgd2l0aCBhIHplcm8gdGltZVN0YXJ0JywgKCkgPT4ge1xuICAgICAgICBsZXQgcmV0dXJuZWRBc3NldDogYW55O1xuICAgICAgICBzZXJ2aWNlVW5kZXJUZXN0LmxvYWQoeyBpZDogJzQ3JywgdGltZVN0YXJ0OiAnMCcgfSwgJ3NlYXJjaCcpLnN1YnNjcmliZShhc3NldCA9PiByZXR1cm5lZEFzc2V0ID0gYXNzZXQpO1xuICAgICAgICBleHBlY3QocmV0dXJuZWRBc3NldCkudG9FcXVhbCh7IHNvbWU6ICdhc3NldCcsIHV1aWQ6IG51bGwsIHRpbWVTdGFydDogMCwgdGltZUVuZDogbnVsbCB9KTtcbiAgICAgIH0pO1xuXG4gICAgICBpdCgncmV0dXJucyB0aGUgZXhwZWN0ZWQgT2JzZXJ2YWJsZSB3aXRoIGEgcG9zaXRpdmUgdGltZVN0YXJ0JywgKCkgPT4ge1xuICAgICAgICBsZXQgcmV0dXJuZWRBc3NldDogYW55O1xuICAgICAgICBzZXJ2aWNlVW5kZXJUZXN0LmxvYWQoeyBpZDogJzQ3JywgdGltZVN0YXJ0OiAnMScgfSwgJ3NlYXJjaCcpLnN1YnNjcmliZShhc3NldCA9PiByZXR1cm5lZEFzc2V0ID0gYXNzZXQpO1xuICAgICAgICBleHBlY3QocmV0dXJuZWRBc3NldCkudG9FcXVhbCh7IHNvbWU6ICdhc3NldCcsIHV1aWQ6IG51bGwsIHRpbWVTdGFydDogMSwgdGltZUVuZDogbnVsbCB9KTtcbiAgICAgIH0pO1xuXG4gICAgICBpdCgncmV0dXJucyB0aGUgZXhwZWN0ZWQgT2JzZXJ2YWJsZSB3aXRoIGEgbmVnYXRpdmUgdGltZUVuZCcsICgpID0+IHtcbiAgICAgICAgbGV0IHJldHVybmVkQXNzZXQ6IGFueTtcbiAgICAgICAgc2VydmljZVVuZGVyVGVzdC5sb2FkKHsgaWQ6ICc0NycsIHRpbWVFbmQ6ICctMScgfSwgJ3NlYXJjaCcpLnN1YnNjcmliZShhc3NldCA9PiByZXR1cm5lZEFzc2V0ID0gYXNzZXQpO1xuICAgICAgICBleHBlY3QocmV0dXJuZWRBc3NldCkudG9FcXVhbCh7IHNvbWU6ICdhc3NldCcsIHV1aWQ6IG51bGwsIHRpbWVTdGFydDogbnVsbCwgdGltZUVuZDogbnVsbCB9KTtcbiAgICAgIH0pO1xuXG4gICAgICBpdCgncmV0dXJucyB0aGUgZXhwZWN0ZWQgT2JzZXJ2YWJsZSB3aXRoIGEgemVybyB0aW1lRW5kJywgKCkgPT4ge1xuICAgICAgICBsZXQgcmV0dXJuZWRBc3NldDogYW55O1xuICAgICAgICBzZXJ2aWNlVW5kZXJUZXN0LmxvYWQoeyBpZDogJzQ3JywgdGltZUVuZDogJzAnIH0sICdzZWFyY2gnKS5zdWJzY3JpYmUoYXNzZXQgPT4gcmV0dXJuZWRBc3NldCA9IGFzc2V0KTtcbiAgICAgICAgZXhwZWN0KHJldHVybmVkQXNzZXQpLnRvRXF1YWwoeyBzb21lOiAnYXNzZXQnLCB1dWlkOiBudWxsLCB0aW1lU3RhcnQ6IG51bGwsIHRpbWVFbmQ6IDAgfSk7XG4gICAgICB9KTtcblxuICAgICAgaXQoJ3JldHVybnMgdGhlIGV4cGVjdGVkIE9ic2VydmFibGUgd2l0aCBhIHBvc2l0aXZlIHRpbWVFbmQnLCAoKSA9PiB7XG4gICAgICAgIGxldCByZXR1cm5lZEFzc2V0OiBhbnk7XG4gICAgICAgIHNlcnZpY2VVbmRlclRlc3QubG9hZCh7IGlkOiAnNDcnLCB0aW1lRW5kOiAnMScgfSwgJ3NlYXJjaCcpLnN1YnNjcmliZShhc3NldCA9PiByZXR1cm5lZEFzc2V0ID0gYXNzZXQpO1xuICAgICAgICBleHBlY3QocmV0dXJuZWRBc3NldCkudG9FcXVhbCh7IHNvbWU6ICdhc3NldCcsIHV1aWQ6IG51bGwsIHRpbWVTdGFydDogbnVsbCwgdGltZUVuZDogMSB9KTtcbiAgICAgIH0pO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnTGVnYWN5IEFzc2V0IFNlcnZpY2UnLCAoKSA9PiB7XG4gICAgbGV0IHNlcnZpY2VVbmRlclRlc3Q6IExlZ2FjeUFzc2V0U2VydmljZTtcbiAgICBsZXQgbW9ja0FwaVNlcnZpY2U6IE1vY2tBcGlTZXJ2aWNlO1xuXG4gICAgYmVmb3JlRWFjaCgoKSA9PiB7XG4gICAgICBqYXNtaW5lLmFkZE1hdGNoZXJzKG1vY2tBcGlNYXRjaGVycyk7XG4gICAgICBtb2NrQXBpU2VydmljZSA9IG5ldyBNb2NrQXBpU2VydmljZSgpO1xuICAgICAgbW9ja0FwaVNlcnZpY2UuZ2V0UmVzcG9uc2UgPSB7IHNvbWU6ICdhc3NldCcgfTtcblxuICAgICAgc2VydmljZVVuZGVyVGVzdCA9IG5ldyBMZWdhY3lBc3NldFNlcnZpY2UobW9ja0FwaVNlcnZpY2UuaW5qZWN0b3IpO1xuICAgIH0pO1xuXG4gICAgZGVzY3JpYmUoJ2NyZWF0ZVNoYXJlTGluaygpJywgKCkgPT4ge1xuICAgICAgaXQoJ2NhbGxzIHRoZSBBUEkgY29ycmVjdGx5JywgKCkgPT4ge1xuICAgICAgICAvLyBzZXJ2aWNlVW5kZXJUZXN0LmNyZWF0ZVNoYXJlTGluayh7IHNvbWU6ICdwb2pvJyB9KTtcbiAgICAgICAgLy8gZXhwZWN0KG1vY2tBcGlTZXJ2aWNlLnBvc3QpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoQXBpKEFwaS5JZGVudGl0aWVzKTtcbiAgICAgICAgLy8gZXhwZWN0KG1vY2tBcGlTZXJ2aWNlLnBvc3QpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoRW5kcG9pbnQoJ2FjY2Vzc0luZm8nKTtcbiAgICAgICAgLy8gZXhwZWN0KG1vY2tBcGlTZXJ2aWNlLnBvc3QpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoQm9keSh7IHNvbWU6ICdwb2pvJyB9KTtcbiAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgZGVzY3JpYmUoJ2dldENsaXBQcmV2aWV3RGF0YSgpJywgKCkgPT4ge1xuICAgICAgaXQoJ2NhbGxzIHRoZSBBUEkgY29ycmVjdGx5JywgKCkgPT4ge1xuICAgICAgICAvLyBzZXJ2aWNlVW5kZXJUZXN0LmdldENsaXBQcmV2aWV3RGF0YSg0Nyk7XG4gICAgICAgIC8vIGV4cGVjdChtb2NrQXBpU2VydmljZS5nZXQpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoQXBpKEFwaS5Bc3NldHMpO1xuICAgICAgICAvLyBleHBlY3QobW9ja0FwaVNlcnZpY2UuZ2V0KS50b0hhdmVCZWVuQ2FsbGVkV2l0aEVuZHBvaW50KCdyZW5kaXRpb25UeXBlLzQ3Jyk7XG4gICAgICAgIC8vIGV4cGVjdChtb2NrQXBpU2VydmljZS5nZXQpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoUGFyYW1ldGVycyh7IHVzZVR5cGU6ICdjbGlwUHJldmlldycgfSk7XG4gICAgICB9KTtcbiAgICB9KTtcbiAgfSk7XG59XG4iXX0=
