<!doctype html>
<html lang="en">
<head>
    <title>Code coverage report for app/store/active-collection/active-collection.service.js</title>
    <meta charset="utf-8" />
    <link rel="stylesheet" href="../../../prettify.css" />
    <link rel="stylesheet" href="../../../base.css" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <style type='text/css'>
        .coverage-summary .sorter {
            background-image: url(../../../sort-arrow-sprite.png);
        }
    </style>
</head>
<body>
<div class='wrapper'>
  <div class='pad1'>
    <h1>
      <a href="../../../index.html">all files</a> / <a href="index.html">app/store/active-collection/</a> active-collection.service.js
    </h1>
    <div class='clearfix'>
      <div class='fl pad1y space-right2'>
        <span class="strong">90.7% </span>
        <span class="quiet">Statements</span>
        <span class='fraction'>78/86</span>
      </div>
      <div class='fl pad1y space-right2'>
        <span class="strong">71.93% </span>
        <span class="quiet">Branches</span>
        <span class='fraction'>41/57</span>
      </div>
      <div class='fl pad1y space-right2'>
        <span class="strong">92.86% </span>
        <span class="quiet">Functions</span>
        <span class='fraction'>26/28</span>
      </div>
      <div class='fl pad1y space-right2'>
        <span class="strong">92% </span>
        <span class="quiet">Lines</span>
        <span class='fraction'>69/75</span>
      </div>
    </div>
  </div>
  <div class='status-line high'></div>
<pre><table class="coverage">
<tr><td class="line-count quiet">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127</td><td class="line-coverage quiet"><span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">2×</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">24×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">4×</span>
<span class="cline-any cline-yes">4×</span>
<span class="cline-any cline-yes">3×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">3×</span>
<span class="cline-any cline-yes">3×</span>
<span class="cline-any cline-yes">2×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">13×</span>
<span class="cline-any cline-yes">13×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">2×</span>
<span class="cline-any cline-yes">2×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">5×</span>
<span class="cline-any cline-yes">5×</span>
<span class="cline-any cline-yes">5×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">5×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">4×</span>
<span class="cline-any cline-yes">4×</span>
<span class="cline-any cline-yes">4×</span>
<span class="cline-any cline-yes">2×</span>
<span class="cline-any cline-yes">4×</span>
<span class="cline-any cline-yes">3×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">4×</span>
<span class="cline-any cline-yes">4×</span>
<span class="cline-any cline-yes">4×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">4×</span>
<span class="cline-any cline-yes">4×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">2×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">5×</span>
<span class="cline-any cline-yes">5×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">15×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">15×</span>
<span class="cline-any cline-yes">14×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">14×</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">14×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span></td><td class="text"><pre class="prettyprint lang-js">"use strict";
var __assign = (this &amp;&amp; this.__assign) || Object.assign || <span class="fstat-no" title="function not covered" ><span class="branch-3 cbranch-no" title="branch not covered" >function(t) {</span></span>
<span class="cstat-no" title="statement not covered" >    for (var s, i = 1, n = arguments.length; i &lt; n; i++) {</span>
<span class="cstat-no" title="statement not covered" >        s = arguments[i];</span>
<span class="cstat-no" title="statement not covered" >        for (var p in s) <span class="cstat-no" title="statement not covered" >if (Object.prototype.hasOwnProperty.call(s, p))</span></span>
<span class="cstat-no" title="statement not covered" >            t[p] = s[p];</span>
    }
<span class="cstat-no" title="statement not covered" >    return t;</span>
};
var __decorate = (this &amp;&amp; this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c &lt; 3 ? target : <span class="branch-1 cbranch-no" title="branch not covered" >desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc,</span> d;
    <span class="missing-if-branch" title="if path not taken" >I</span>if (typeof Reflect === "object" &amp;&amp; typeof Reflect.decorate === "function") <span class="cstat-no" title="statement not covered" >r = Reflect.decorate(decorators, target, key, desc);</span>
    else for (var i = decorators.length - 1; i &gt;= 0; i--) <span class="missing-if-branch" title="else path not taken" >E</span>if (d = decorators[i]) r = (c &lt; 3 ? d(r) : <span class="branch-1 cbranch-no" title="branch not covered" >c &gt; 3 ? d(target, key, r) : d(target, key))</span> || r;
    return c &gt; 3 &amp;&amp; <span class="branch-1 cbranch-no" title="branch not covered" >r </span>&amp;&amp; <span class="branch-2 cbranch-no" title="branch not covered" >Object.defineProperty(target, key, r),</span> r;
};
var __metadata = (this &amp;&amp; this.__metadata) || function (k, v) {
    <span class="missing-if-branch" title="else path not taken" >E</span>if (typeof Reflect === "object" &amp;&amp; typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};
Object.defineProperty(exports, "__esModule", { value: true });
var core_1 = require("@angular/core");
var Observable_1 = require("rxjs/Observable");
var api_service_1 = require("../api/api.service");
var api_interface_1 = require("../../shared/interfaces/api.interface");
var SubclipMarkersInterface = require("../../shared/interfaces/subclip-markers");
var common_functions_1 = require("../../shared/utilities/common.functions");
var ActiveCollectionService = (function () {
    function ActiveCollectionService(apiService) {
        this.apiService = apiService;
    }
    ActiveCollectionService.prototype.load = function (parameters) {
        var _this = this;
        return this.apiService.get(api_interface_1.Api.Assets, 'collectionSummary/focused', { loadingIndicator: true })
            .flatMap(function (summaryResponse) { return _this.combineAssetsWith(summaryResponse, parameters); });
    };
    ActiveCollectionService.prototype.set = function (collectionId, parameters) {
        var _this = this;
        return this.apiService.put(api_interface_1.Api.Assets, "collectionSummary/setFocused/" + collectionId, { loadingIndicator: true })
            .flatMap(function (summaryResponse) { return _this.combineAssetsWith(summaryResponse, parameters); });
    };
    ActiveCollectionService.prototype.loadPage = function (collectionId, parameters) {
        var _this = this;
        return this.apiService.get(api_interface_1.Api.Assets, "collectionSummary/assets/" + collectionId, { parameters: this.convertToApiParameters(parameters), loadingIndicator: true }).map(function (res) { return _this.convertToCollectionItems(res); });
    };
    ActiveCollectionService.prototype.loadFocusedPage = function (parameters, totalAssetsAdded) {
        var _this = this;
        return this.apiService.get(api_interface_1.Api.Assets, 'collectionSummary/assets/focused', { parameters: this.convertToApiParameters(parameters), loadingIndicator: true }).map(function (res) { return _this.convertToCollectionItems(res, totalAssetsAdded); });
    };
    ActiveCollectionService.prototype.addAssetTo = function (activeCollection, asset, markers) {
        var _this = this;
        var duration = SubclipMarkersInterface.durationFrom(markers);
        var assetInfo = {
            assetId: asset.assetId,
            timeStart: String(duration.timeStart),
            timeEnd: String(duration.timeEnd)
        };
        return this.apiService.post(api_interface_1.Api.Identities, 'collection/focused/addAssets', { body: { list: [assetInfo] }, loadingIndicator: true }).flatMap(function (res) { return res.list
            ? _this.loadPage(activeCollection.id, { currentPage: 1, pageSize: activeCollection.assets.pagination.pageSize })
            : Observable_1.Observable.of({ items: [], pagination: {} }); });
    };
    ActiveCollectionService.prototype.removeAssetFrom = function (activeCollection, asset) {
        var _this = this;
        var pagination = activeCollection.assets.pagination;
        if (!asset.uuid)
            asset = activeCollection.assets.items.find(function (otherAsset) { return otherAsset.assetId === asset.assetId; });
        return this.apiService.post(api_interface_1.Api.Identities, "collection/focused/removeAssets", { body: { list: [asset.uuid] }, loadingIndicator: true }).flatMap(function () {
            return _this.loadPage(activeCollection.id, { currentPage: pagination.currentPage, pageSize: pagination.pageSize });
        });
    };
    ActiveCollectionService.prototype.updateAssetMarkers = function (activeCollection, asset, updatedMarkers) {
        var _this = this;
        var duration = SubclipMarkersInterface.durationFrom(updatedMarkers);
        var updater = {
            uuid: asset.uuid,
            assetId: asset.assetId,
            timeStart: String(duration.timeStart),
            timeEnd: String(duration.timeEnd)
        };
        var pagination = activeCollection.assets.pagination;
        return this.apiService.put(api_interface_1.Api.Identities, "collection/focused/updateAsset", { body: updater, loadingIndicator: true })
            .flatMap(function (response) {
            return _this.loadPage(activeCollection.id, { currentPage: pagination.currentPage, pageSize: pagination.pageSize });
        });
    };
    ActiveCollectionService.prototype.addAssetsToFocusedCollection = function (assets, pagination) {
        var _this = this;
        var formattedAssets = assets.map(function (a) { return { assetId: a.assetId }; });
        return this.apiService.post(api_interface_1.Api.Identities, 'collection/focused/addAssets', { body: { list: formattedAssets }, loadingIndicator: true }).flatMap(<span class="fstat-no" title="function not covered" >function (res) {</span>
<span class="cstat-no" title="statement not covered" >            return _this.loadFocusedPage({ currentPage: pagination.currentPage, pageSize: pagination.pageSize }, res.list ? res.list.length : 0);</span>
        });
    };
    ActiveCollectionService.prototype.combineAssetsWith = function (collectionSummary, parameters) {
        return this.loadPage(collectionSummary.id, parameters)
            .map(function (assets) { return (__assign({}, collectionSummary, { assets: assets })); });
    };
    ActiveCollectionService.prototype.convertToApiParameters = function (parameters) {
        return {
            i: String(parameters.currentPage - 1),
            n: String(parameters.pageSize)
        };
    };
    ActiveCollectionService.prototype.convertToCollectionItems = function (response, totalAssetsAdded) {
        var convertedItems = (response.items || []).map(function (item) { return (__assign({}, item, { timeStart: parseInt(item.timeStart), timeEnd: parseInt(item.timeEnd) })); });
        var collectionItems = {
            items: convertedItems,
            pagination: {
                totalCount: response.totalCount || 0,
                currentPage: (response.currentPage || 0) + 1,
                pageSize: response.pageSize || 0,
                hasNextPage: response.hasNextPage || false,
                hasPreviousPage: response.hasPreviousPage || false,
                numberOfPages: response.numberOfPages || 0
            }
        };
        if (common_functions_1.Common.isNotNullOrUndefined(totalAssetsAdded))
            collectionItems = __assign({}, collectionItems, { totalAssetsAdded: totalAssetsAdded });
        return collectionItems;
    };
    ActiveCollectionService = __decorate([
        core_1.Injectable(),
        __metadata("design:paramtypes", [api_service_1.FutureApiService])
    ], ActiveCollectionService);
    return ActiveCollectionService;
}());
exports.ActiveCollectionService = ActiveCollectionService;
&nbsp;
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC9zdG9yZS9hY3RpdmUtY29sbGVjdGlvbi9hY3RpdmUtY29sbGVjdGlvbi5zZXJ2aWNlLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBQSxzQ0FBMkM7QUFDM0MsOENBQTZDO0FBRTdDLGtEQUFzRDtBQUN0RCx1RUFBd0U7QUFNeEUsaUZBQW1GO0FBRW5GLDRFQUFpRTtBQUdqRTtJQUNFLGlDQUFvQixVQUE0QjtRQUE1QixlQUFVLEdBQVYsVUFBVSxDQUFrQjtJQUFJLENBQUM7SUFFOUMsc0NBQUksR0FBWCxVQUFZLFVBQTBDO1FBQXRELGlCQUdDO1FBRkMsTUFBTSxDQUFDLElBQUksQ0FBQyxVQUFVLENBQUMsR0FBRyxDQUFDLG1CQUFHLENBQUMsTUFBTSxFQUFFLDJCQUEyQixFQUFFLEVBQUUsZ0JBQWdCLEVBQUUsSUFBSSxFQUFFLENBQUM7YUFDNUYsT0FBTyxDQUFDLFVBQUMsZUFBMkIsSUFBSyxPQUFBLEtBQUksQ0FBQyxpQkFBaUIsQ0FBQyxlQUFlLEVBQUUsVUFBVSxDQUFDLEVBQW5ELENBQW1ELENBQUMsQ0FBQztJQUNuRyxDQUFDO0lBRU0scUNBQUcsR0FBVixVQUFXLFlBQW9CLEVBQUUsVUFBMEM7UUFBM0UsaUJBR0M7UUFGQyxNQUFNLENBQUMsSUFBSSxDQUFDLFVBQVUsQ0FBQyxHQUFHLENBQUMsbUJBQUcsQ0FBQyxNQUFNLEVBQUUsa0NBQWdDLFlBQWMsRUFBRSxFQUFFLGdCQUFnQixFQUFFLElBQUksRUFBRSxDQUFDO2FBQy9HLE9BQU8sQ0FBQyxVQUFDLGVBQTJCLElBQUssT0FBQSxLQUFJLENBQUMsaUJBQWlCLENBQUMsZUFBZSxFQUFFLFVBQVUsQ0FBQyxFQUFuRCxDQUFtRCxDQUFDLENBQUM7SUFDbkcsQ0FBQztJQUdNLDBDQUFRLEdBQWYsVUFBZ0IsWUFBb0IsRUFBRSxVQUEwQztRQUFoRixpQkFNQztRQUxDLE1BQU0sQ0FBQyxJQUFJLENBQUMsVUFBVSxDQUFDLEdBQUcsQ0FDeEIs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eUI7UUFDM0YsSUFBTSxjQUFjLEdBQ2xCLENBQUMsUUFBUSxDQUFDLEtBQUssSUFBSSxFQUFFLENBQUMsQ0FBQyxHQUFHLENBQUMsVUFBQSxJQUFJLElBQUksT0FBQSxjQUFNLElBQUksSUFBRSxTQUFTLEVBQUUsUUFBUSxDQUFDLElBQUksQ0FBQyxTQUFTLENBQUMsRUFBRSxPQUFPLEVBQUUsUUFBUSxDQUFDLElBQUksQ0FBQyxPQUFPLENBQUMsSUFBRyxFQUFuRixDQUFtRixDQUFDLENBQUM7UUFFMUgsSUFBSSxlQUFlLEdBQW9CO1lBQ3JDLEtBQUssRUFBRSxjQUFjO1lBQ3JCLFVBQVUsRUFBRTtnQkFDVixVQUFVLEVBQUUsUUFBUSxDQUFDLFVBQVUsSUFBSSxDQUFDO2dCQUNwQyxXQUFXLEVBQUUsQ0FBQyxRQUFRLENBQUMsV0FBVyxJQUFJLENBQUMsQ0FBQyxHQUFHLENBQUM7Z0JBQzVDLFFBQVEsRUFBRSxRQUFRLENBQUMsUUFBUSxJQUFJLENBQUM7Z0JBQ2hDLFdBQVcsRUFBRSxRQUFRLENBQUMsV0FBVyxJQUFJLEtBQUs7Z0JBQzFDLGVBQWUsRUFBRSxRQUFRLENBQUMsZUFBZSxJQUFJLEtBQUs7Z0JBQ2xELGFBQWEsRUFBRSxRQUFRLENBQUMsYUFBYSxJQUFJLENBQUM7YUFDM0M7U0FDRixDQUFDO1FBRUYsRUFBRSxDQUFDLENBQUMseUJBQU0sQ0FBQyxvQkFBb0IsQ0FBQyxnQkFBZ0IsQ0FBQyxDQUFDO1lBQUMsZUFBZSxnQkFBUSxlQUFlLElBQUUsZ0JBQWdCLGtCQUFBLEdBQUUsQ0FBQztRQUU5RyxNQUFNLENBQUMsZUFBZSxDQUFDO0lBQ3pCLENBQUM7SUFqSVUsdUJBQXVCO1FBRG5DLGlCQUFVLEVBQUU7eUNBRXFCLDhCQUFnQjtPQURyQyx1QkFBdUIsQ0FrSW5DO0lBQUQsOEJBQUM7Q0FsSUQsQUFrSUMsSUFBQTtBQWxJWSwwREFBdUIiLCJmaWxlIjoiYXBwL3N0b3JlL2FjdGl2ZS1jb2xsZWN0aW9uL2FjdGl2ZS1jb2xsZWN0aW9uLnNlcnZpY2UuanMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBJbmplY3RhYmxlIH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5pbXBvcnQgeyBPYnNlcnZhYmxlIH0gZnJvbSAncnhqcy9PYnNlcnZhYmxlJztcblxuaW1wb3J0IHsgRnV0dXJlQXBpU2VydmljZSB9IGZyb20gJy4uL2FwaS9hcGkuc2VydmljZSc7XG5pbXBvcnQgeyBBcGksIEFwaU9wdGlvbnMgfSBmcm9tICcuLi8uLi9zaGFyZWQvaW50ZXJmYWNlcy9hcGkuaW50ZXJmYWNlJztcbmltcG9ydCB7XG4gIENvbGxlY3Rpb24sIENvbGxlY3Rpb25QYWdpbmF0aW9uUGFyYW1ldGVycywgQ29sbGVjdGlvbkl0ZW1zLCBDb2xsZWN0aW9uSXRlbU1hcmtlcnNVcGRhdGVyLFxuICBDb2xsZWN0aW9uSXRlbXNSZXNwb25zZSwgQ29sbGVjdGlvbkFzc2V0UmVzcG9uc2UsIEFkZEFzc2V0VG9Db2xsZWN0aW9uUmVzcG9uc2Vcbn0gZnJvbSAnLi4vLi4vc2hhcmVkL2ludGVyZmFjZXMvY29sbGVjdGlvbi5pbnRlcmZhY2UnO1xuaW1wb3J0IHsgQXNzZXQsIFBhZ2luYXRpb24gfSBmcm9tICcuLi8uLi9zaGFyZWQvaW50ZXJmYWNlcy9jb21tb24uaW50ZXJmYWNlJztcbmltcG9ydCAqIGFzIFN1YmNsaXBNYXJrZXJzSW50ZXJmYWNlIGZyb20gJy4uLy4uL3NoYXJlZC9pbnRlcmZhY2VzL3N1YmNsaXAtbWFya2Vycyc7XG5pbXBvcnQgeyBGcmFtZSB9IGZyb20gJy4uLy4uL3NoYXJlZC9tb2R1bGVzL3dhemVlLWZyYW1lLWZvcm1hdHRlci9pbmRleCc7XG5pbXBvcnQgeyBDb21tb24gfSBmcm9tICcuLi8uLi9zaGFyZWQvdXRpbGl0aWVzL2NvbW1vbi5mdW5jdGlvbnMnO1xuXG5ASW5qZWN0YWJsZSgpXG5leHBvcnQgY2xhc3MgQWN0aXZlQ29sbGVjdGlvblNlcnZpY2Uge1xuICBjb25zdHJ1Y3Rvcihwcml2YXRlIGFwaVNlcnZpY2U6IEZ1dHVyZUFwaVNlcnZpY2UpIHsgfVxuXG4gIHB1YmxpYyBsb2FkKHBhcmFtZXRlcnM6IENvbGxlY3Rpb25QYWdpbmF0aW9uUGFyYW1ldGVycyk6IE9ic2VydmFibGU8Q29sbGVjdGlvbj4ge1xuICAgIHJldHVybiB0aGlzLmFwaVNlcnZpY2UuZ2V0KEFwaS5Bc3NldHMsICdjb2xsZWN0aW9uU3VtbWFyeS9mb2N1c2VkJywgeyBsb2FkaW5nSW5kaWNhdG9yOiB0cnVlIH0pXG4gICAgICAuZmxhdE1hcCgoc3VtbWFyeVJlc3BvbnNlOiBDb2xsZWN0aW9uKSA9PiB0aGlzLmNvbWJpbmVBc3NldHNXaXRoKHN1bW1hcnlSZXNwb25zZSwgcGFyYW1ldGVycykpO1xuICB9XG5cbiAgcHVibGljIHNldChjb2xsZWN0aW9uSWQ6IG51bWJlciwgcGFyYW1ldGVyczogQ29sbGVjdGlvblBhZ2luYXRpb25QYXJhbWV0ZXJzKTogT2JzZXJ2YWJsZTxDb2xsZWN0aW9uPiB7XG4gICAgcmV0dXJuIHRoaXMuYXBpU2VydmljZS5wdXQoQXBpLkFzc2V0cywgYGNvbGxlY3Rpb25TdW1tYXJ5L3NldEZvY3VzZWQvJHtjb2xsZWN0aW9uSWR9YCwgeyBsb2FkaW5nSW5kaWNhdG9yOiB0cnVlIH0pXG4gICAgICAuZmxhdE1hcCgoc3VtbWFyeVJlc3BvbnNlOiBDb2xsZWN0aW9uKSA9PiB0aGlzLmNvbWJpbmVBc3NldHNXaXRoKHN1bW1hcnlSZXNwb25zZSwgcGFyYW1ldGVycykpO1xuICB9XG5cbiAgLy8gRGVwcmVjYXRlZCEgcGxlYXNlIHVzZSBsb2FkRm9jdXNlZFBhZ2UoKSBmb3IgbG9hZGluZyBmb2N1c2VkIGNvbGxlY3Rpb24gYXNzZXRzXG4gIHB1YmxpYyBsb2FkUGFnZShjb2xsZWN0aW9uSWQ6IG51bWJlciwgcGFyYW1ldGVyczogQ29sbGVjdGlvblBhZ2luYXRpb25QYXJhbWV0ZXJzKTogT2JzZXJ2YWJsZTxDb2xsZWN0aW9uSXRlbXM+IHtcbiAgICByZXR1cm4gdGhpcy5hcGlTZXJ2aWNlLmdldChcbiAgICAgIEFwaS5Bc3NldHMsXG4gICAgICBgY29sbGVjdGlvblN1bW1hcnkvYXNzZXRzLyR7Y29sbGVjdGlvbklkfWAsXG4gICAgICB7IHBhcmFtZXRlcnM6IHRoaXMuY29udmVydFRvQXBpUGFyYW1ldGVycyhwYXJhbWV0ZXJzKSwgbG9hZGluZ0luZGljYXRvcjogdHJ1ZSB9XG4gICAgKS5tYXAoKHJlcykgPT4gdGhpcy5jb252ZXJ0VG9Db2xsZWN0aW9uSXRlbXMocmVzKSk7XG4gIH1cblxuICAvLyBSZXBsYWNlcyBsb2FkUGFnZSgpXG4gIHB1YmxpYyBsb2FkRm9jdXNlZFBhZ2UocGFyYW1ldGVyczogQ29sbGVjdGlvblBhZ2luYXRpb25QYXJhbWV0ZXJzLCB0b3RhbEFzc2V0c0FkZGVkOiBudW1iZXIpOiBPYnNlcnZhYmxlPENvbGxlY3Rpb25JdGVtcz4ge1xuICAgIHJldHVybiB0aGlzLmFwaVNlcnZpY2UuZ2V0KFxuICAgICAgQXBpLkFzc2V0cyxcbiAgICAgICdjb2xsZWN0aW9uU3VtbWFyeS9hc3NldHMvZm9jdXNlZCcsXG4gICAgICB7IHBhcmFtZXRlcnM6IHRoaXMuY29udmVydFRvQXBpUGFyYW1ldGVycyhwYXJhbWV0ZXJzKSwgbG9hZGluZ0luZGljYXRvcjogdHJ1ZSB9XG4gICAgKS5tYXAoKHJlcykgPT4gdGhpcy5jb252ZXJ0VG9Db2xsZWN0aW9uSXRlbXMocmVzLCB0b3RhbEFzc2V0c0FkZGVkKSk7XG4gIH1cblxuICBwdWJsaWMgYWRkQXNzZXRUbyhcbiAgICBhY3RpdmVDb2xsZWN0aW9uOiBDb2xsZWN0aW9uLFxuICAgIGFzc2V0OiBBc3NldCxcbiAgICBtYXJrZXJzOiBTdWJjbGlwTWFya2Vyc0ludGVyZmFjZS5TdWJjbGlwTWFya2Vyc1xuICApOiBPYnNlcnZhYmxlPENvbGxlY3Rpb25JdGVtcz4ge1xuICAgIGNvbnN0IGR1cmF0aW9uOiBTdWJjbGlwTWFya2Vyc0ludGVyZmFjZS5EdXJhdGlvbiA9IFN1YmNsaXBNYXJrZXJzSW50ZXJmYWNlLmR1cmF0aW9uRnJvbShtYXJrZXJzKTtcbiAgICBjb25zdCBhc3NldEluZm86IG9iamVjdCA9IHtcbiAgICAgIGFzc2V0SWQ6IGFzc2V0LmFzc2V0SWQsXG4gICAgICB0aW1lU3RhcnQ6IFN0cmluZyhkdXJhdGlvbi50aW1lU3RhcnQpLFxuICAgICAgdGltZUVuZDogU3RyaW5nKGR1cmF0aW9uLnRpbWVFbmQpXG4gICAgfTtcblxuICAgIHJldHVybiB0aGlzLmFwaVNlcnZpY2UucG9zdChcbiAgICAgIEFwaS5JZGVudGl0aWVzLCAnY29sbGVjdGlvbi9mb2N1c2VkL2FkZEFzc2V0cycsIHsgYm9keTogeyBsaXN0OiBbYXNzZXRJbmZvXSB9LCBsb2FkaW5nSW5kaWNhdG9yOiB0cnVlIH1cbiAgICApLmZsYXRNYXAocmVzID0+IHJlcy5saXN0XG4gICAgICA/IHRoaXMubG9hZFBhZ2UoYWN0aXZlQ29sbGVjdGlvbi5pZCwgeyBjdXJyZW50UGFnZTogMSwgcGFnZVNpemU6IGFjdGl2ZUNvbGxlY3Rpb24uYXNzZXRzLnBhZ2luYXRpb24ucGFnZVNpemUgfSlcbiAgICAgIDogT2JzZXJ2YWJsZS5vZih7IGl0ZW1zOiBbXSBhcyBBc3NldFtdLCBwYWdpbmF0aW9uOiB7fSBhcyBQYWdpbmF0aW9uIH0pXG4gICAgKTtcbiAgfVxuXG4gIHB1YmxpYyByZW1vdmVBc3NldEZyb20oYWN0aXZlQ29sbGVjdGlvbjogQ29sbGVjdGlvbiwgYXNzZXQ6IEFzc2V0KTogT2JzZXJ2YWJsZTxDb2xsZWN0aW9uSXRlbXM+IHtcbiAgICBjb25zdCBwYWdpbmF0aW9uOiBQYWdpbmF0aW9uID0gYWN0aXZlQ29sbGVjdGlvbi5hc3NldHMucGFnaW5hdGlvbjtcblxuICAgIC8vIElmIHdlIGNvbWUgZnJvbSBzb21ld2hlcmUgdGhhdCBkb2Vzbid0IGtub3cgYWJvdXQgY29sbGVjdGlvbiBVVUlEcyAobGlrZSBzZWFyY2ggcmVzdWx0cyksIHRoZW4gd2VcbiAgICAvLyAoc29tZXdoYXQgcXVlc3Rpb25hYmx5KSBqdXN0IGZpbmQgYW55IGFzc2V0IGluIHRoZSBjb2xsZWN0aW9uIHdpdGggdGhpcyBhc3NldCdzIHNhbWUgYXNzZXRJRCBhbmQgcmVtb3ZlIGl0LlxuICAgIGlmICghYXNzZXQudXVpZCkgYXNzZXQgPSBhY3RpdmVDb2xsZWN0aW9uLmFzc2V0cy5pdGVtcy5maW5kKG90aGVyQXNzZXQgPT4gb3RoZXJBc3NldC5hc3NldElkID09PSBhc3NldC5hc3NldElkKTtcblxuICAgIHJldHVybiB0aGlzLmFwaVNlcnZpY2UucG9zdChcbiAgICAgIEFwaS5JZGVudGl0aWVzLCBgY29sbGVjdGlvbi9mb2N1c2VkL3JlbW92ZUFzc2V0c2AsIHsgYm9keTogeyBsaXN0OiBbYXNzZXQudXVpZF0gfSwgbG9hZGluZ0luZGljYXRvcjogdHJ1ZSB9XG4gICAgKS5mbGF0TWFwKCgpID0+XG4gICAgICB0aGlzLmxvYWRQYWdlKGFjdGl2ZUNvbGxlY3Rpb24uaWQsIHsgY3VycmVudFBhZ2U6IHBhZ2luYXRpb24uY3VycmVudFBhZ2UsIHBhZ2VTaXplOiBwYWdpbmF0aW9uLnBhZ2VTaXplIH0pXG4gICAgKTtcbiAgfVxuXG4gIHB1YmxpYyB1cGRhdGVBc3NldE1hcmtlcnMoXG4gICAgYWN0aXZlQ29sbGVjdGlvbjogQ29sbGVjdGlvbiwgYXNzZXQ6IEFzc2V0LCB1cGRhdGVkTWFya2VyczogU3ViY2xpcE1hcmtlcnNJbnRlcmZhY2UuU3ViY2xpcE1hcmtlcnNcbiAgKTogT2JzZXJ2YWJsZTxDb2xsZWN0aW9uSXRlbXM+IHtcbiAgICBjb25zdCBkdXJhdGlvbjogU3ViY2xpcE1hcmtlcnNJbnRlcmZhY2UuRHVyYXRpb24gPSBTdWJjbGlwTWFya2Vyc0ludGVyZmFjZS5kdXJhdGlvbkZyb20odXBkYXRlZE1hcmtlcnMpO1xuICAgIGNvbnN0IHVwZGF0ZXI6IENvbGxlY3Rpb25JdGVtTWFya2Vyc1VwZGF0ZXIgPSB7XG4gICAgICB1dWlkOiBhc3NldC51dWlkLFxuICAgICAgYXNzZXRJZDogYXNzZXQuYXNzZXRJZCxcbiAgICAgIHRpbWVTdGFydDogU3RyaW5nKGR1cmF0aW9uLnRpbWVTdGFydCksXG4gICAgICB0aW1lRW5kOiBTdHJpbmcoZHVyYXRpb24udGltZUVuZClcbiAgICB9O1xuICAgIGNvbnN0IHBhZ2luYXRpb246IFBhZ2luYXRpb24gPSBhY3RpdmVDb2xsZWN0aW9uLmFzc2V0cy5wYWdpbmF0aW9uO1xuXG4gICAgcmV0dXJuIHRoaXMuYXBpU2VydmljZS5wdXQoQXBpLklkZW50aXRpZXMsIGBjb2xsZWN0aW9uL2ZvY3VzZWQvdXBkYXRlQXNzZXRgLCB7IGJvZHk6IHVwZGF0ZXIsIGxvYWRpbmdJbmRpY2F0b3I6IHRydWUgfSlcbiAgICAgIC5mbGF0TWFwKHJlc3BvbnNlID0+XG4gICAgICAgIHRoaXMubG9hZFBhZ2UoYWN0aXZlQ29sbGVjdGlvbi5pZCwgeyBjdXJyZW50UGFnZTogcGFnaW5hdGlvbi5jdXJyZW50UGFnZSwgcGFnZVNpemU6IHBhZ2luYXRpb24ucGFnZVNpemUgfSlcbiAgICAgICk7XG4gIH1cblxuICBwdWJsaWMgYWRkQXNzZXRzVG9Gb2N1c2VkQ29sbGVjdGlvbihhc3NldHM6IEFzc2V0W10sIHBhZ2luYXRpb246IFBhZ2luYXRpb24pOiBPYnNlcnZhYmxlPENvbGxlY3Rpb25JdGVtcz4ge1xuICAgIGNvbnN0IGZvcm1hdHRlZEFzc2V0czogeyBhc3NldElkOiBudW1iZXIgfVtdID0gYXNzZXRzLm1hcChhID0+IHsgcmV0dXJuIHsgYXNzZXRJZDogYS5hc3NldElkIH07IH0pO1xuXG4gICAgcmV0dXJuIHRoaXMuYXBpU2VydmljZS5wb3N0KFxuICAgICAgQXBpLklkZW50aXRpZXMsXG4gICAgICAnY29sbGVjdGlvbi9mb2N1c2VkL2FkZEFzc2V0cycsXG4gICAgICB7IGJvZHk6IHsgbGlzdDogZm9ybWF0dGVkQXNzZXRzIH0sIGxvYWRpbmdJbmRpY2F0b3I6IHRydWUgfVxuICAgICkuZmxhdE1hcCgocmVzOiBBZGRBc3NldFRvQ29sbGVjdGlvblJlc3BvbnNlKSA9PiB7XG4gICAgICByZXR1cm4gdGhpcy5sb2FkRm9jdXNlZFBhZ2UoXG4gICAgICAgIHsgY3VycmVudFBhZ2U6IHBhZ2luYXRpb24uY3VycmVudFBhZ2UsIHBhZ2VTaXplOiBwYWdpbmF0aW9uLnBhZ2VTaXplIH0sXG4gICAgICAgIHJlcy5saXN0ID8gcmVzLmxpc3QubGVuZ3RoIDogMFxuICAgICAgKTtcbiAgICB9KTtcbiAgfVxuXG4gIHByaXZhdGUgY29tYmluZUFzc2V0c1dpdGgoY29sbGVjdGlvblN1bW1hcnk6IENvbGxlY3Rpb24sIHBhcmFtZXRlcnM6IENvbGxlY3Rpb25QYWdpbmF0aW9uUGFyYW1ldGVycyk6IE9ic2VydmFibGU8Q29sbGVjdGlvbj4ge1xuICAgIHJldHVybiB0aGlzLmxvYWRQYWdlKGNvbGxlY3Rpb25TdW1tYXJ5LmlkLCBwYXJhbWV0ZXJzKVxuICAgICAgLm1hcCgoYXNzZXRzOiBDb2xsZWN0aW9uSXRlbXMpID0+ICh7IC4uLmNvbGxlY3Rpb25TdW1tYXJ5LCBhc3NldHM6IGFzc2V0cyB9KSk7XG4gIH1cblxuICBwcml2YXRlIGNvbnZlcnRUb0FwaVBhcmFtZXRlcnMocGFyYW1ldGVyczogQ29sbGVjdGlvblBhZ2luYXRpb25QYXJhbWV0ZXJzKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIGk6IFN0cmluZyhwYXJhbWV0ZXJzLmN1cnJlbnRQYWdlIC0gMSksIC8vIENvbnZlcnQgVUkgb25lLWJhc2VkIHBhZ2UgdG8gQVBJIHplcm8tYmFzZWQgcGFnZS5cbiAgICAgIG46IFN0cmluZyhwYXJhbWV0ZXJzLnBhZ2VTaXplKVxuICAgIH07XG4gIH1cblxuICBwcml2YXRlIGNvbnZlcnRUb0NvbGxlY3Rpb25JdGVtcyhyZXNwb25zZTogQ29sbGVjdGlvbkl0ZW1zUmVzcG9uc2UsIHRvdGFsQXNzZXRzQWRkZWQ/OiBudW1iZXIpOiBDb2xsZWN0aW9uSXRlbXMge1xuICAgIGNvbnN0IGNvbnZlcnRlZEl0ZW1zOiBBc3NldFtdID1cbiAgICAgIChyZXNwb25zZS5pdGVtcyB8fCBbXSkubWFwKGl0ZW0gPT4gKHsgLi4uaXRlbSwgdGltZVN0YXJ0OiBwYXJzZUludChpdGVtLnRpbWVTdGFydCksIHRpbWVFbmQ6IHBhcnNlSW50KGl0ZW0udGltZUVuZCkgfSkpO1xuXG4gICAgbGV0IGNvbGxlY3Rpb25JdGVtczogQ29sbGVjdGlvbkl0ZW1zID0ge1xuICAgICAgaXRlbXM6IGNvbnZlcnRlZEl0ZW1zLFxuICAgICAgcGFnaW5hdGlvbjoge1xuICAgICAgICB0b3RhbENvdW50OiByZXNwb25zZS50b3RhbENvdW50IHx8IDAsXG4gICAgICAgIGN1cnJlbnRQYWdlOiAocmVzcG9uc2UuY3VycmVudFBhZ2UgfHwgMCkgKyAxLCAvLyBDb252ZXJ0IEFQSSB6ZXJvLWJhc2VkIHBhZ2UgdG8gVUkgb25lLWJhc2VkIHBhZ2UuXG4gICAgICAgIHBhZ2VTaXplOiByZXNwb25zZS5wYWdlU2l6ZSB8fCAwLFxuICAgICAgICBoYXNOZXh0UGFnZTogcmVzcG9uc2UuaGFzTmV4dFBhZ2UgfHwgZmFsc2UsXG4gICAgICAgIGhhc1ByZXZpb3VzUGFnZTogcmVzcG9uc2UuaGFzUHJldmlvdXNQYWdlIHx8IGZhbHNlLFxuICAgICAgICBudW1iZXJPZlBhZ2VzOiByZXNwb25zZS5udW1iZXJPZlBhZ2VzIHx8IDBcbiAgICAgIH1cbiAgICB9O1xuXG4gICAgaWYgKENvbW1vbi5pc05vdE51bGxPclVuZGVmaW5lZCh0b3RhbEFzc2V0c0FkZGVkKSkgY29sbGVjdGlvbkl0ZW1zID0geyAuLi5jb2xsZWN0aW9uSXRlbXMsIHRvdGFsQXNzZXRzQWRkZWQgfTtcblxuICAgIHJldHVybiBjb2xsZWN0aW9uSXRlbXM7XG4gIH1cbn1cbiJdfQ==
&nbsp;</pre></td></tr>
</table></pre>
<div class='push'></div><!-- for sticky footer -->
</div><!-- /wrapper -->
<div class='footer quiet pad2 space-top1 center small'>
  Code coverage
  generated by <a href="http://istanbul-js.org/" target="_blank">istanbul</a> at Fri Feb 09 2018 23:34:44 GMT-0700 (MST)
</div>
</div>
<script src="../../../prettify.js"></script>
<script>
window.onload = function () {
        if (typeof prettyPrint === 'function') {
            prettyPrint();
        }
};
</script>
<script src="../../../sorter.js"></script>
</body>
</html>
